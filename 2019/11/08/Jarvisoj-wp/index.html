<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/1.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/1.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/1.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Jarvisoj,">





  <link rel="alternate" href="/atom.xml" title="IFpop" type="application/atom+xml">






<meta name="description" content="CryptoXgmRSA-集锦 xbkRSA-集锦 xyf加密结构使用的是Feistel结构 加密过程如下： 123456780,L,R1,R,L^R^K12,L^R^K1,L^K1^K23,L^K1^K2,R^K2^K34,R^K2^K3,L^R^K1^K3^K45,L^R^K1^K3^K4,L^K1^K2^K4^K56,L^K1^K2^K4^K5,R^K2^K3^K5^K67,R^K2^K3^">
<meta name="keywords" content="Jarvisoj">
<meta property="og:type" content="article">
<meta property="og:title" content="Jarvisoj-wp">
<meta property="og:url" content="https://IFpop.github.io/2019/11/08/Jarvisoj-wp/index.html">
<meta property="og:site_name" content="IFpop">
<meta property="og:description" content="CryptoXgmRSA-集锦 xbkRSA-集锦 xyf加密结构使用的是Feistel结构 加密过程如下： 123456780,L,R1,R,L^R^K12,L^R^K1,L^K1^K23,L^K1^K2,R^K2^K34,R^K2^K3,L^R^K1^K3^K45,L^R^K1^K3^K4,L^K1^K2^K4^K56,L^K1^K2^K4^K5,R^K2^K3^K5^K67,R^K2^K3^">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://img.baidu.com/hi/jx2/j_0065.gif">
<meta property="og:image" content="https://ifpop.github.io/2019/11/08/Jarvisoj-wp/Users/X1TABLET/Desktop/image2.png">
<meta property="og:image" content="https://ifpop.github.io/2019/11/08/Jarvisoj-wp/Users/96552/AppData/Roaming/Typora/typora-user-images/1573611867291.png">
<meta property="og:updated_time" content="2019-11-14T07:18:27.062Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jarvisoj-wp">
<meta name="twitter:description" content="CryptoXgmRSA-集锦 xbkRSA-集锦 xyf加密结构使用的是Feistel结构 加密过程如下： 123456780,L,R1,R,L^R^K12,L^R^K1,L^K1^K23,L^K1^K2,R^K2^K34,R^K2^K3,L^R^K1^K3^K45,L^R^K1^K3^K4,L^K1^K2^K4^K56,L^K1^K2^K4^K5,R^K2^K3^K5^K67,R^K2^K3^">
<meta name="twitter:image" content="https://img.baidu.com/hi/jx2/j_0065.gif">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://IFpop.github.io/2019/11/08/Jarvisoj-wp/">





  <title>Jarvisoj-wp | IFpop</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    <a href="https://github.com/IFpop" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; left: 0; transform: scale(-1, 1);" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style></a>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">IFpop</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Stay Hungry, Stay Foolish</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br>
            
            Sitemap
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://IFpop.github.io/2019/11/08/Jarvisoj-wp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="IFpop">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IFpop">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Jarvisoj-wp</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-08T00:17:47+08:00">
                2019-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/wp/" itemprop="url" rel="index">
                    <span itemprop="name">wp</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/wp/CTF/" itemprop="url" rel="index">
                    <span itemprop="name">CTF</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i> 浏览
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>次
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  10k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  50 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body " itemprop="articleBody">

      
      

      
        <h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Xgm"><a href="#Xgm" class="headerlink" title="Xgm"></a>Xgm</h2><p><a href="https://ifpop.github.io/2019/10/21/RSA-%E9%9B%86%E9%94%A6/#more">RSA-集锦</a></p>
<h2 id="xbk"><a href="#xbk" class="headerlink" title="xbk"></a>xbk</h2><p><a href="https://ifpop.github.io/2019/10/21/RSA-%E9%9B%86%E9%94%A6/#more">RSA-集锦</a></p>
<h2 id="xyf"><a href="#xyf" class="headerlink" title="xyf"></a>xyf</h2><p>加密结构使用的是<code>Feistel结构</code></p>
<p>加密过程如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>,L,R</span><br><span class="line"><span class="number">1</span>,R,L^R^K1</span><br><span class="line"><span class="number">2</span>,L^R^K1,L^K1^K2</span><br><span class="line"><span class="number">3</span>,L^K1^K2,R^K2^K3</span><br><span class="line"><span class="number">4</span>,R^K2^K3,L^R^K1^K3^K4</span><br><span class="line"><span class="number">5</span>,L^R^K1^K3^K4,L^K1^K2^K4^K5</span><br><span class="line"><span class="number">6</span>,L^K1^K2^K4^K5,R^K2^K3^K5^K6</span><br><span class="line"><span class="number">7</span>,R^K2^K3^K5^K6,L^R^K1^K3^K4^K6^K7</span><br></pre></td></tr></table></figure>
<p>那么逻辑就很清楚了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">test = <span class="string">"50543fc0bca1bb4f21300f0074990f846a8009febded0b2198324c1b31d2e2563c908dcabbc461f194e70527e03a807e9a478f9a56f7"</span></span><br><span class="line">R_test^K2^K3^K5^K6     L_test^R_test^K1^K3^K4^K6^K7</span><br><span class="line">R_flag^K2^K3^K5^K6     L_flag^R_flag^K1^K3^K4^K6^K7</span><br></pre></td></tr></table></figure>
<p>然后解密脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#owner: IFpop</span></span><br><span class="line"><span class="comment">#time: 2019/10/29</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#这里本来想着用python3实现这个过程，但是关于hex解码，在python3上貌似不能解码奇数，但可能是我代码写错了，希望解决了的大神可以告诉我怎么实现</span></span><br><span class="line">test = <span class="string">'50543fc0bca1bb4f21300f0074990f846a8009febded0b2198324c1b31d2e2563c908dcabbc461f194e70527e03a807e9a478f9a56f7'</span></span><br><span class="line">test_out = <span class="string">'66bbd551d9847c1a10755987b43f8b214ee9c6ec2949eef01321b0bc42cffce6bdbd604924e5cbd99b7c56cf461561186921087fa1e9'</span></span><br><span class="line">flag_out = <span class="string">'44fc6f82bdd0dff9aca3e0e82cbb9d6683516524c245494b89c272a83d2b88452ec0bfa0a73ffb42e304fe3748896111b9bdf4171903'</span></span><br><span class="line"></span><br><span class="line">L_tesd = test.decode(<span class="string">'hex'</span>)[<span class="number">0</span>:<span class="number">27</span>]</span><br><span class="line">R_test = test.decode(<span class="string">'hex'</span>)[<span class="number">27</span>:<span class="number">54</span>]</span><br><span class="line"></span><br><span class="line">L_Ktest = test_out.decode(<span class="string">'hex'</span>)[<span class="number">0</span>:<span class="number">27</span>]</span><br><span class="line">R_Ktest = test_out.decode(<span class="string">'hex'</span>)[<span class="number">27</span>:<span class="number">54</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(a,b)</span>:</span></span><br><span class="line">    <span class="keyword">assert</span> len(a)==len(b)</span><br><span class="line">    c=<span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">        c+=chr(ord(a[i])^ord(b[i]))</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">L_Kflag = flag_out.decode(<span class="string">'hex'</span>)[<span class="number">0</span>:<span class="number">27</span>]</span><br><span class="line">R_Kflag = flag_out.decode(<span class="string">'hex'</span>)[<span class="number">27</span>:<span class="number">54</span>]</span><br><span class="line"></span><br><span class="line">R_flag = xor(L_Kflag,xor(L_Ktest,R_test))</span><br><span class="line">L_flag = xor(xor(xor(xor(L_tesd,R_test), R_Ktest),R_Kflag), R_flag)</span><br><span class="line">print(L_flag+R_flag)</span><br><span class="line"><span class="comment">#flag&#123;festel_weak_666_10fjid9vh12h3nvm&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="xcaesar"><a href="#xcaesar" class="headerlink" title="xcaesar"></a>xcaesar</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">caesar_encrypt</span><span class="params">(m,k)</span>:</span></span><br><span class="line">    r=<span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">        r+=chr((ord(i)+k)%<span class="number">128</span>)</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> m,k</span><br><span class="line"><span class="keyword">print</span> caesar_encrypt(m,k).encode(<span class="string">"base64"</span>)</span><br><span class="line"><span class="comment">#output:bXNobgJyaHB6aHRwdGgE</span></span><br></pre></td></tr></table></figure>
<p>程序很明显，先将明文进行凯撒加密，随后对其进行base64编码，所以脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#owner: IFpop</span></span><br><span class="line"><span class="comment">#time: 2019/10/29</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">str = <span class="string">"bXNobgJyaHB6aHRwdGgE"</span></span><br><span class="line">str = base64.b64decode(str)</span><br><span class="line">print(str)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">26</span>):</span><br><span class="line">    ans = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> str:</span><br><span class="line">        <span class="keyword">if</span> c &gt;= <span class="string">'A'</span> <span class="keyword">and</span> c &lt;= <span class="string">'Z'</span>:</span><br><span class="line">            <span class="keyword">if</span> c.isalpha():</span><br><span class="line">                ans += chr((ord(c) + i<span class="number">-65</span>)%<span class="number">26</span>+<span class="number">65</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                ans += c</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> c.isalpha():</span><br><span class="line">                ans += chr((ord(c) + i<span class="number">-97</span>)%<span class="number">26</span>+<span class="number">97</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                ans += c</span><br><span class="line">    print(ans)</span><br><span class="line"><span class="comment"># flag&#123;kaisamima&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="xbase64"><a href="#xbase64" class="headerlink" title="xbase64"></a>xbase64</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /usr/bin/python</span></span><br><span class="line"><span class="comment"># encoding: utf-8</span></span><br><span class="line">base64_table = [<span class="string">'='</span>,<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>,<span class="string">'E'</span>,<span class="string">'F'</span>,<span class="string">'G'</span>,<span class="string">'H'</span>,<span class="string">'I'</span>,<span class="string">'J'</span>,<span class="string">'K'</span>,<span class="string">'L'</span>,<span class="string">'M'</span>,<span class="string">'N'</span>,<span class="string">'O'</span>,<span class="string">'P'</span>,<span class="string">'Q'</span>,<span class="string">'R'</span>,<span class="string">'S'</span>,<span class="string">'T'</span>,<span class="string">'U'</span>,<span class="string">'V'</span>,<span class="string">'W'</span>,<span class="string">'X'</span>,<span class="string">'Y'</span>,<span class="string">'Z'</span>,</span><br><span class="line">                <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>,<span class="string">'e'</span>,<span class="string">'f'</span>,<span class="string">'g'</span>,<span class="string">'h'</span>,<span class="string">'i'</span>,<span class="string">'j'</span>,<span class="string">'k'</span>,<span class="string">'l'</span>,<span class="string">'m'</span>,<span class="string">'n'</span>,<span class="string">'o'</span>,<span class="string">'p'</span>,<span class="string">'q'</span>,<span class="string">'r'</span>,<span class="string">'s'</span>,<span class="string">'t'</span>,<span class="string">'u'</span>,<span class="string">'v'</span>,<span class="string">'w'</span>,<span class="string">'x'</span>,<span class="string">'y'</span>,<span class="string">'z'</span>,</span><br><span class="line">                <span class="string">'0'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>,<span class="string">'4'</span>,<span class="string">'5'</span>,<span class="string">'6'</span>,<span class="string">'7'</span>,<span class="string">'8'</span>,<span class="string">'9'</span>,</span><br><span class="line">                <span class="string">'+'</span>, <span class="string">'/'</span>][::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode_b64</span><span class="params">(s)</span>:</span></span><br><span class="line">    l = len(s)</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    result = <span class="string">''</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; l:</span><br><span class="line">        <span class="comment"># 将字符转换为二进制编码，然后对齐</span></span><br><span class="line">        s1 = s[i]</span><br><span class="line">        b1 = bin(ord(s1))[<span class="number">2</span>:]</span><br><span class="line">        cb1 = b1.rjust(<span class="number">8</span>, <span class="string">'0'</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> i &gt;= l:</span><br><span class="line">            cb2 = <span class="string">'00000000'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            s2 = s[i]</span><br><span class="line">            b2 = bin(ord(s2))[<span class="number">2</span>:]</span><br><span class="line">            cb2 = b2.rjust(<span class="number">8</span>, <span class="string">'0'</span>)</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> i &gt;= l:</span><br><span class="line">            cb3 = <span class="string">'00000000'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            s3 = s[i]</span><br><span class="line">            b3 = bin(ord(s3))[<span class="number">2</span>:]</span><br><span class="line">            cb3 = b3.rjust(<span class="number">8</span>, <span class="string">'0'</span>)</span><br><span class="line">        <span class="comment"># 将三字节转换为四字节</span></span><br><span class="line">        cb = cb1 + cb2 + cb3</span><br><span class="line">        rb1 = cb[:<span class="number">6</span>]</span><br><span class="line">        rb2 = cb[<span class="number">6</span>:<span class="number">12</span>]</span><br><span class="line">        rb3 = cb[<span class="number">12</span>:<span class="number">18</span>]</span><br><span class="line">        rb4 = cb[<span class="number">18</span>:]</span><br><span class="line">        <span class="comment"># 转换后的编码转为十进制备用</span></span><br><span class="line">        ri1 = int(rb1, <span class="number">2</span>)</span><br><span class="line">        ri2 = int(rb2, <span class="number">2</span>)</span><br><span class="line">        ri3 = int(rb3, <span class="number">2</span>)</span><br><span class="line">        ri4 = int(rb4, <span class="number">2</span>)</span><br><span class="line">        <span class="comment"># 处理末尾为０的情况，以＇＝＇填充</span></span><br><span class="line">        <span class="keyword">if</span> i - <span class="number">1</span> &gt;= l <span class="keyword">and</span> ri3 == <span class="number">0</span>:</span><br><span class="line">            ri3 = <span class="number">-1</span></span><br><span class="line">        <span class="keyword">if</span> i &gt;= l <span class="keyword">and</span> ri4 == <span class="number">0</span>:</span><br><span class="line">            ri4 = <span class="number">-1</span></span><br><span class="line">        result += base64_table[ri1] + base64_table[ri2] + base64_table[ri3] + base64_table[ri4]</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"><span class="keyword">print</span> encode_b64(open(<span class="string">"flag"</span>,<span class="string">"r"</span>).read())</span><br><span class="line"></span><br><span class="line"><span class="comment">#output: mZOemISXmpOTkKCHkp6Rgv==</span></span><br></pre></td></tr></table></figure>
<p>乍一看，以为直接是，直接解码，发现是失败的，看看上面的base64_table，发现跟本来的不太一样，现在采取的策略是将原本的base64表与现在的base64表进行一个映射，然后就可以用base64进行解码了。脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#owner: IFpop</span></span><br><span class="line"><span class="comment">#time: 2019/10/29</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">xbase64=[<span class="string">'/'</span>, <span class="string">'+'</span>, <span class="string">'9'</span>, <span class="string">'8'</span>, <span class="string">'7'</span>, <span class="string">'6'</span>, <span class="string">'5'</span>, <span class="string">'4'</span>, <span class="string">'3'</span>, <span class="string">'2'</span>, <span class="string">'1'</span>, <span class="string">'0'</span>, <span class="string">'z'</span>, <span class="string">'y'</span>, <span class="string">'x'</span>, <span class="string">'w'</span>, <span class="string">'v'</span>, <span class="string">'u'</span>, <span class="string">'t'</span>, <span class="string">'s'</span>, <span class="string">'r'</span>, <span class="string">'q'</span>, <span class="string">'p'</span>, <span class="string">'o'</span>, <span class="string">'n'</span>, <span class="string">'m'</span>, <span class="string">'l'</span>, <span class="string">'k'</span>, <span class="string">'j'</span>, <span class="string">'i'</span>, <span class="string">'h'</span>, <span class="string">'g'</span>, <span class="string">'f'</span>, <span class="string">'e'</span>, <span class="string">'d'</span>, <span class="string">'c'</span>, <span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'Z'</span>, <span class="string">'Y'</span>, <span class="string">'X'</span>, <span class="string">'W'</span>, <span class="string">'V'</span>, <span class="string">'U'</span>, <span class="string">'T'</span>, <span class="string">'S'</span>, <span class="string">'R'</span>, <span class="string">'Q'</span>, <span class="string">'P'</span>, <span class="string">'O'</span>, <span class="string">'N'</span>, <span class="string">'M'</span>, <span class="string">'L'</span>, <span class="string">'K'</span>, <span class="string">'J'</span>, <span class="string">'I'</span>, <span class="string">'H'</span>, <span class="string">'G'</span>, <span class="string">'F'</span>, <span class="string">'E'</span>, <span class="string">'D'</span>, <span class="string">'C'</span>, <span class="string">'B'</span>, <span class="string">'A'</span>, <span class="string">'='</span>]</span><br><span class="line">base64= [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>, <span class="string">'E'</span>, <span class="string">'F'</span>, <span class="string">'G'</span>, <span class="string">'H'</span>, <span class="string">'I'</span>, <span class="string">'J'</span>, <span class="string">'K'</span>, <span class="string">'L'</span>, <span class="string">'M'</span>, <span class="string">'N'</span>, <span class="string">'O'</span>, <span class="string">'P'</span>, <span class="string">'Q'</span>, <span class="string">'R'</span>, <span class="string">'S'</span>, <span class="string">'T'</span>, <span class="string">'U'</span>, <span class="string">'V'</span>, <span class="string">'W'</span>, <span class="string">'X'</span>, <span class="string">'Y'</span>, <span class="string">'Z'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>, <span class="string">'g'</span>, <span class="string">'h'</span>, <span class="string">'i'</span>, <span class="string">'j'</span>, <span class="string">'k'</span>, <span class="string">'l'</span>, <span class="string">'m'</span>, <span class="string">'n'</span>, <span class="string">'o'</span>, <span class="string">'p'</span>, <span class="string">'q'</span>, <span class="string">'r'</span>, <span class="string">'s'</span>, <span class="string">'t'</span>, <span class="string">'u'</span>, <span class="string">'v'</span>, <span class="string">'w'</span>, <span class="string">'x'</span>, <span class="string">'y'</span>, <span class="string">'z'</span>, <span class="string">'0'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>, <span class="string">'5'</span>, <span class="string">'6'</span>, <span class="string">'7'</span>, <span class="string">'8'</span>, <span class="string">'9'</span>, <span class="string">'+'</span>, <span class="string">'/'</span>, <span class="string">'='</span>]</span><br><span class="line"></span><br><span class="line">str=<span class="string">'mZOemISXmpOTkKCHkp6Rgv=='</span></span><br><span class="line">s=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> str:</span><br><span class="line">    s+=base64[xbase64.index(i)]</span><br><span class="line">print(s)</span><br><span class="line"><span class="comment"># ZmxhZ3toZWxsb194bWFufQ==</span></span><br><span class="line">print(s.decode(<span class="string">'base64'</span>))</span><br><span class="line"><span class="comment"># flag&#123;hello_xman&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="Cry"><a href="#Cry" class="headerlink" title="Cry"></a>Cry</h2><p><a href="https://ifpop.github.io/2019/10/21/RSA-%E9%9B%86%E9%94%A6/#more">RSA-集锦</a></p>
<h2 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h2><h2 id="rsappend"><a href="#rsappend" class="headerlink" title="rsappend"></a>rsappend</h2><p><a href="https://ifpop.github.io/2019/10/21/RSA-%E9%9B%86%E9%94%A6/#more">RSA-集锦</a></p>
<h2 id="bbencode"><a href="#bbencode" class="headerlink" title="bbencode"></a>bbencode</h2><p>下载下来是一个python文件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">flag = open(<span class="string">"flag"</span>, <span class="string">"r"</span>).read().strip()</span><br><span class="line"><span class="keyword">assert</span> len(flag) == <span class="number">32</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str2num</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> int(s.encode(<span class="string">'hex'</span>), <span class="number">16</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bbencode</span><span class="params">(n)</span>:</span></span><br><span class="line">    a = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> bin(n)[<span class="number">2</span>:]:</span><br><span class="line">        a = a &lt;&lt; <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> (int(i)):</span><br><span class="line">            a = a ^ n</span><br><span class="line">        <span class="keyword">if</span> a &gt;&gt; <span class="number">256</span>:</span><br><span class="line">            a = a ^ <span class="number">0x10000000000000000000000000000000000000000000000000000000000000223L</span></span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> bbencode(str2num(flag))</span><br><span class="line"><span class="comment">#result:61406787709715709430385495960238216763226399960658358000016620560764164045692</span></span><br></pre></td></tr></table></figure>
<p>这个加密先将flag转成二进制，然后根据每一位二进制数，对a进行操作，也就是一直对其循环加密就能得到<code>flag</code>(这里为什么我也没想明白)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#owner:IFpop</span></span><br><span class="line"><span class="comment">#time:2019/10/29</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bbencode</span><span class="params">(n)</span>:</span></span><br><span class="line">    a = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> bin(n)[<span class="number">2</span>:]:</span><br><span class="line">        a = a &lt;&lt; <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> (int(i)):</span><br><span class="line">            a = a ^ n</span><br><span class="line">        <span class="keyword">if</span> a &gt;&gt; <span class="number">256</span>:</span><br><span class="line">            a = a ^ <span class="number">0x10000000000000000000000000000000000000000000000000000000000000223L</span></span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line">flag = <span class="number">61406787709715709430385495960238216763226399960658358000016620560764164045692</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000000</span>):</span><br><span class="line">    flag = bbencode(flag)</span><br><span class="line">    <span class="comment">#flag -- 66 6c 61 67</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="string">'666c6167'</span> == str(hex(flag)[<span class="number">2</span>:<span class="number">10</span>])):</span><br><span class="line">        print(i)</span><br><span class="line">        print(number.long_to_bytes(flag))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment">#flag&#123;you_xian_yu_huan_le_duo_!!&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="Complicated-Crypto"><a href="#Complicated-Crypto" class="headerlink" title="Complicated Crypto"></a>Complicated Crypto</h2><blockquote>
<p>五层密码，好复杂<img src="https://img.baidu.com/hi/jx2/j_0065.gif" alt="img"></p>
</blockquote>
<h3 id="CRC爆破"><a href="#CRC爆破" class="headerlink" title="CRC爆破"></a>CRC爆破</h3><p>下载下来是一个被加密的压缩包：<code>Complicated Crypto.7z</code></p>
<p>由于7z的压缩包是无视伪加密的，但有没有密码的相关信息，使用<code>winrar</code>打开可以看到有四个文件，其中有个名称叫做<code>CRC Collision</code>，所以现在尝试进行CRC爆破</p>
<p>可以直接使用脚本进行攻击，<a href="https://github.com/theonlypwner/crc32" target="_blank" rel="noopener">6位爆破神器下载地址</a>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python crc32.py reverse 0xA58A1926</span><br><span class="line"><span class="comment">#_CRC32</span></span><br><span class="line">python crc32.py reverse 0x4DAD5967</span><br><span class="line"><span class="comment">#_i5_n0</span></span><br><span class="line">python crc32.py reverse 0x4DAD5967</span><br><span class="line"><span class="comment">#t_s4f3</span></span><br></pre></td></tr></table></figure>
<p>或者使用这个：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#crc32_util.py</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">crc32_reverse_class</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, crc32, length, tbl=string.printable,</span></span></span><br><span class="line"><span class="function"><span class="params">                 poly=<span class="number">0xEDB88320</span>, accum=<span class="number">0</span>)</span>:</span></span><br><span class="line">        self.char_set = set(map(ord, tbl))</span><br><span class="line">        self.crc32 = crc32</span><br><span class="line">        self.length = length</span><br><span class="line">        self.poly = poly</span><br><span class="line">        self.accum = accum</span><br><span class="line">        self.table = []</span><br><span class="line">        self.table_reverse = []</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">init_tables</span><span class="params">(self, poly, reverse=True)</span>:</span></span><br><span class="line">        <span class="comment"># build CRC32 table</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">                <span class="keyword">if</span> i &amp; <span class="number">1</span>:</span><br><span class="line">                    i &gt;&gt;= <span class="number">1</span></span><br><span class="line">                    i ^= poly</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    i &gt;&gt;= <span class="number">1</span></span><br><span class="line">            self.table.append(i)</span><br><span class="line">        <span class="keyword">assert</span> len(self.table) == <span class="number">256</span>, <span class="string">"table is wrong size"</span></span><br><span class="line">        <span class="comment"># build reverse table</span></span><br><span class="line">        <span class="keyword">if</span> reverse:</span><br><span class="line">            found_none = set()</span><br><span class="line">            found_multiple = set()</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">                found = []</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">                    <span class="keyword">if</span> self.table[j] &gt;&gt; <span class="number">24</span> == i:</span><br><span class="line">                        found.append(j)</span><br><span class="line">                self.table_reverse.append(tuple(found))</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">                    found_none.add(i)</span><br><span class="line">                <span class="keyword">elif</span> len(found) &gt; <span class="number">1</span>:</span><br><span class="line">                    found_multiple.add(i)</span><br><span class="line">            <span class="keyword">assert</span> len(self.table_reverse) == <span class="number">256</span>, <span class="string">"reverse table is wrong size"</span></span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rangess</span><span class="params">(self, i)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">', '</span>.join(map(<span class="keyword">lambda</span> x: <span class="string">'[&#123;0&#125;,&#123;1&#125;]'</span>.format(*x), self.ranges(i)))</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">ranges</span><span class="params">(self, i)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> kg <span class="keyword">in</span> itertools.groupby(enumerate(i), <span class="keyword">lambda</span> x: x[<span class="number">1</span>] - x[<span class="number">0</span>]):</span><br><span class="line">            g = list(kg[<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">yield</span> g[<span class="number">0</span>][<span class="number">1</span>], g[<span class="number">-1</span>][<span class="number">1</span>]</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">calc</span><span class="params">(self, data, accum=<span class="number">0</span>)</span>:</span></span><br><span class="line">        accum = ~accum</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> data:</span><br><span class="line">            accum = self.table[(accum ^ b) &amp; <span class="number">0xFF</span>] ^ (</span><br><span class="line">                (accum &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0x00FFFFFF</span>)</span><br><span class="line">        accum = ~accum</span><br><span class="line">        <span class="keyword">return</span> accum &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findReverse</span><span class="params">(self, desired, accum)</span>:</span></span><br><span class="line">        solutions = set()</span><br><span class="line">        accum = ~accum</span><br><span class="line">        stack = [(~desired,)]</span><br><span class="line">        <span class="keyword">while</span> stack:</span><br><span class="line">            node = stack.pop()</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> self.table_reverse[(node[<span class="number">0</span>] &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>]:</span><br><span class="line">                <span class="keyword">if</span> len(node) == <span class="number">4</span>:</span><br><span class="line">                    a = accum</span><br><span class="line">                    data = []</span><br><span class="line">                    node = node[<span class="number">1</span>:] + (j,)</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">                        data.append((a ^ node[i]) &amp; <span class="number">0xFF</span>)</span><br><span class="line">                        a &gt;&gt;= <span class="number">8</span></span><br><span class="line">                        a ^= self.table[node[i]]</span><br><span class="line">                    solutions.add(tuple(data))</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    stack.append(((node[<span class="number">0</span>] ^ self.table[j]) &lt;&lt; <span class="number">8</span>,) + node[<span class="number">1</span>:] + (j,))</span><br><span class="line">        <span class="keyword">return</span> solutions</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dfs</span><span class="params">(self, length, outlist=[<span class="string">''</span>])</span>:</span></span><br><span class="line">        tmp_list = []</span><br><span class="line">        <span class="keyword">if</span> length == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> outlist</span><br><span class="line">        <span class="keyword">for</span> list_item <span class="keyword">in</span> outlist:</span><br><span class="line">            tmp_list.extend([list_item + chr(x) <span class="keyword">for</span> x <span class="keyword">in</span> self.char_set])</span><br><span class="line">        <span class="keyword">return</span> self.dfs(length - <span class="number">1</span>, tmp_list)</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run_reverse</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.init_tables(self.poly)</span><br><span class="line">        desired = self.crc32</span><br><span class="line">        accum = self.accum</span><br><span class="line">        <span class="keyword">if</span> self.length &gt;= <span class="number">4</span>:</span><br><span class="line">            patches = self.findReverse(desired, accum)</span><br><span class="line">            <span class="keyword">for</span> patch <span class="keyword">in</span> patches:</span><br><span class="line">                checksum = self.calc(patch, accum)</span><br><span class="line">                <span class="keyword">print</span> <span class="string">'verification checksum: 0x&#123;0:08x&#125; (&#123;1&#125;)'</span>.format(</span><br><span class="line">                    checksum, <span class="string">'OK'</span> <span class="keyword">if</span> checksum == desired <span class="keyword">else</span> <span class="string">'ERROR'</span>)</span><br><span class="line">            <span class="keyword">for</span> item <span class="keyword">in</span> self.dfs(self.length - <span class="number">4</span>):</span><br><span class="line">                patch = map(ord, item)</span><br><span class="line">                patches = self.findReverse(desired, self.calc(patch, accum))</span><br><span class="line">                <span class="keyword">for</span> last_4_bytes <span class="keyword">in</span> patches:</span><br><span class="line">                    <span class="keyword">if</span> all(p <span class="keyword">in</span> self.char_set <span class="keyword">for</span> p <span class="keyword">in</span> last_4_bytes):</span><br><span class="line">                        patch.extend(last_4_bytes)</span><br><span class="line">                        <span class="keyword">print</span> <span class="string">'[find]: &#123;1&#125; (&#123;0&#125;)'</span>.format(</span><br><span class="line">                            <span class="string">'OK'</span> <span class="keyword">if</span> self.calc(patch, accum) == desired <span class="keyword">else</span> <span class="string">'ERROR'</span>, <span class="string">''</span>.join(map(chr, patch)))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">for</span> item <span class="keyword">in</span> self.dfs(self.length):</span><br><span class="line">                <span class="keyword">if</span> crc32(item) == desired:</span><br><span class="line">                    <span class="keyword">print</span> <span class="string">'[find]: &#123;0&#125; (OK)'</span>.format(item)</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crc32_reverse</span><span class="params">(crc32, length, char_set=string.printable,</span></span></span><br><span class="line"><span class="function"><span class="params">                  poly=<span class="number">0xEDB88320</span>, accum=<span class="number">0</span>)</span>:</span></span><br><span class="line">    obj = crc32_reverse_class(crc32, length, char_set, poly, accum)</span><br><span class="line">    obj.run_reverse()</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crc32</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> binascii.crc32(s) &amp; <span class="number">0xffffffff</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> crc32_util <span class="keyword">import</span> *</span><br><span class="line">crc = [<span class="number">0x7C2DF918</span>,</span><br><span class="line">       <span class="number">0xA58A1926</span>,</span><br><span class="line">       <span class="number">0x4DAD5967</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> crc:</span><br><span class="line">    crc32_reverse(i, <span class="number">6</span>)</span><br></pre></td></tr></table></figure>
<p>连起来就是<code>_CRC32_i5_n0t_s4f3</code>,这个就是压缩包的密码</p>
<h3 id="vigenere"><a href="#vigenere" class="headerlink" title="vigenere"></a>vigenere</h3><p>打开后里面，还有个压缩包，查看里面的<code>tips.txt</code>文件，是个维吉尼亚密码</p>
<p>但是密钥数量太多，现在上<a href="http://inventwithpython.com/hacking/diff/" target="_blank" rel="noopener">解密模板</a>网站上找到相应解密模板</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment">#vigenereDictionaryHacker.py</span></span><br><span class="line"><span class="keyword">import</span> detectEnglish</span><br><span class="line"></span><br><span class="line">LETTERS = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">translateMessage</span><span class="params">(key, message, mode)</span>:</span></span><br><span class="line">    translated = [] <span class="comment"># 存储加密/解密消息字符串</span></span><br><span class="line">    keyIndex = <span class="number">0</span></span><br><span class="line">    key = key.upper()</span><br><span class="line">    <span class="keyword">for</span> symbol <span class="keyword">in</span> message: <span class="comment"># 遍历每个消息里的字符的消息</span></span><br><span class="line">        num = LETTERS.find(symbol.upper())</span><br><span class="line">        <span class="keyword">if</span> num != <span class="number">-1</span>: <span class="comment"># -1 意味着转换为大写在LETTERS找不到</span></span><br><span class="line">            <span class="keyword">if</span> mode == <span class="string">'encrypt'</span>:</span><br><span class="line">                num += LETTERS.find(key[keyIndex]) <span class="comment"># 加密时相加</span></span><br><span class="line">            <span class="keyword">elif</span> mode == <span class="string">'decrypt'</span>:</span><br><span class="line">                num -= LETTERS.find(key[keyIndex]) <span class="comment"># 解密时相减</span></span><br><span class="line">            num %= len(LETTERS) <span class="comment"># 处理潜在的循环           </span></span><br><span class="line">            <span class="comment"># 添加转换后加密/解密字符</span></span><br><span class="line">            <span class="keyword">if</span> symbol.isupper():</span><br><span class="line">                translated.append(LETTERS[num])</span><br><span class="line">            <span class="keyword">elif</span> symbol.islower():</span><br><span class="line">                translated.append(LETTERS[num].lower())</span><br><span class="line">            keyIndex += <span class="number">1</span> <span class="comment"># 继续下一个用密钥字符来解密</span></span><br><span class="line">            <span class="keyword">if</span> keyIndex == len(key):</span><br><span class="line">                keyIndex = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 字符不在LETTERS里直接添加</span></span><br><span class="line">            translated.append(symbol)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(translated)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decryptMessage</span><span class="params">(key, message)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> translateMessage(key, message, <span class="string">'decrypt'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hackVigenere</span><span class="params">(ciphertext)</span>:</span></span><br><span class="line">    fo = open(<span class="string">'keys.txt'</span>)</span><br><span class="line">    words = fo.readlines()</span><br><span class="line">    fo.close()</span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> words:</span><br><span class="line">        word = word.strip()</span><br><span class="line">        decryptedText = decryptMessage(word, ciphertext)</span><br><span class="line">        <span class="keyword">if</span> detectEnglish.isEnglish(decryptedText, wordPercentage=<span class="number">40</span>):</span><br><span class="line">            print(<span class="string">'------------------------&gt;&gt;&gt;Notice!&lt;&lt;&lt;----------------------'</span>)</span><br><span class="line">            print(<span class="string">'Possible encryption break:'</span>)</span><br><span class="line">            print(<span class="string">'-&gt;&gt;Possible key: '</span> + str(word))</span><br><span class="line">            print(<span class="string">'-&gt;&gt;Possible plaintext: '</span> + decryptedText[:<span class="number">100</span>])</span><br><span class="line">            print(<span class="string">'Enter D for done, or just press Enter to continue breaking:'</span>)</span><br><span class="line">            response = raw_input(<span class="string">'&gt; '</span>)</span><br><span class="line">            <span class="keyword">if</span> response.upper().startswith(<span class="string">'D'</span>):</span><br><span class="line">                <span class="keyword">return</span> decryptedText</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    ciphertext = <span class="string">"""rla xymijgpf ppsoto wq u nncwel ff tfqlgnxwzz sgnlwduzmy vcyg ib bhfbe u tnaxua ff satzmpibf vszqen eyvlatq cnzhk dk hfy mnciuzj ou s yygusfp bl dq e okcvpa hmsz vi wdimyfqqjqubzc hmpmbgxifbgi qs lciyaktb jf clntkspy drywuz wucfm"""</span></span><br><span class="line">    hackedMessage = hackVigenere(ciphertext)</span><br><span class="line">    <span class="keyword">if</span> hackedMessage != <span class="literal">None</span>:</span><br><span class="line">        print(<span class="string">'\nCopy Possible plaintext to the clipboard:\n'</span>)</span><br><span class="line">        print(hackedMessage)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'Failed to hack encryption.'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># detectEnglish.py</span></span><br><span class="line"><span class="comment"># 英文单词探测模块</span></span><br><span class="line"><span class="comment"># 模块引用:</span></span><br><span class="line"><span class="comment">#   import detectEnglish</span></span><br><span class="line"><span class="comment">#   detectEnglish.isEnglish(someString) # 返回真或假</span></span><br><span class="line"><span class="comment"># 模块需要一个包含常见英文单词的"words.txt"，下载地址：http://invpy.com/dictionary.txt</span></span><br><span class="line"><span class="comment"># 将dictionary.txt改成word.txt</span></span><br><span class="line">UPPERLETTERS = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></span><br><span class="line">LETTERS_AND_SPACE = UPPERLETTERS + UPPERLETTERS.lower() + <span class="string">' \t\n'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loadDictionary</span><span class="params">()</span>:</span></span><br><span class="line">    dictionaryFile = open(<span class="string">'word.txt'</span>)</span><br><span class="line">    englishWords = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> dictionaryFile.read().split(<span class="string">'\n'</span>):</span><br><span class="line">        englishWords[word] = <span class="literal">None</span></span><br><span class="line">    dictionaryFile.close()</span><br><span class="line">    <span class="keyword">return</span> englishWords</span><br><span class="line"></span><br><span class="line">ENGLISH_WORDS = loadDictionary()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getEnglishCount</span><span class="params">(message)</span>:</span></span><br><span class="line">    message = message.upper()</span><br><span class="line">    message = removeNonLetters(message)</span><br><span class="line">    possibleWords = message.split()</span><br><span class="line">    <span class="comment"># print possibleWords</span></span><br><span class="line">    <span class="keyword">if</span> possibleWords == []:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0.0</span> <span class="comment"># 没有单词返回0.0</span></span><br><span class="line"></span><br><span class="line">    matches = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> possibleWords:</span><br><span class="line">        <span class="keyword">if</span> word <span class="keyword">in</span> ENGLISH_WORDS:</span><br><span class="line">            matches += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> float(matches) / len(possibleWords)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">removeNonLetters</span><span class="params">(message)</span>:</span></span><br><span class="line">    lettersOnly = []</span><br><span class="line">    <span class="keyword">for</span> symbol <span class="keyword">in</span> message:</span><br><span class="line">        <span class="keyword">if</span> symbol <span class="keyword">in</span> LETTERS_AND_SPACE:</span><br><span class="line">            lettersOnly.append(symbol)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(lettersOnly)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isEnglish</span><span class="params">(message, wordPercentage=<span class="number">20</span>, letterPercentage=<span class="number">85</span>)</span>:</span></span><br><span class="line">    <span class="comment"># 默认设置转换后的message中单词的20%能在words.txt中的单词列表找到</span></span><br><span class="line">    <span class="comment"># 默认设置转换后的message中85%是字母或空格</span></span><br><span class="line">    <span class="comment"># (not punctuation or numbers).</span></span><br><span class="line">    wordsMatch = getEnglishCount(message) * <span class="number">100</span> &gt;= wordPercentage</span><br><span class="line">    numLetters = len(removeNonLetters(message))</span><br><span class="line">    messageLettersPercentage = float(numLetters) / len(message) * <span class="number">100</span></span><br><span class="line">    lettersMatch = messageLettersPercentage &gt;= letterPercentage</span><br><span class="line">    <span class="keyword">return</span> wordsMatch <span class="keyword">and</span> lettersMatch</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ python vigenereDictionaryHacker.py</span><br><span class="line">------------------------&gt;&gt;&gt;Notice!&lt;&lt;&lt;----------------------  </span><br><span class="line">Possible encryption <span class="built_in">break</span>:  </span><br><span class="line">-&gt;&gt;Possible key: YEWCQGEWCYBNHDHPXOYUBJJPQIRAPSOUIYEOMTSV  </span><br><span class="line">-&gt;&gt;Possible plaintext: the vigenere cipher is a method of encrypting alphabetic text by using a series of different caesar</span><br></pre></td></tr></table></figure>
<p>然后在线解密：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">the vigenere cipher is a method of encrypting alphabetic text by using a series of different caesar ciphers based on the letters of a keyword it is a simple form of polyalphabetic substitution so password is vigenere cipher funny</span><br></pre></td></tr></table></figure>
<p><code>vigenere cipher funny</code>就是密码</p>
<h3 id="sha1爆破"><a href="#sha1爆破" class="headerlink" title="sha1爆破"></a><code>sha1</code>爆破</h3><p>然后解压：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">恭喜!</span><br><span class="line">现在我们遇到一个问题,我们有一个zip文件,但我们不知道完整的解压密码。</span><br><span class="line">幸好我们知道解压密码的一部分sha1值。</span><br><span class="line">你能帮我们找到的密码吗?</span><br><span class="line">不完整的密码：&quot;*7*5-*4*3?&quot;  *代表可打印字符</span><br><span class="line">不完整的sha1：&quot;619c20c*a4de755*9be9a8b*b7cbfa5*e8b4365*&quot;  *代表可打印字符</span><br><span class="line">人生苦短，我用Python。</span><br></pre></td></tr></table></figure>
<p>使用模板进行<code>sha1</code>爆破，下面是个demo程序：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#break_sha1.py</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">match</span><span class="params">(h,pwd)</span>:</span></span><br><span class="line">    hl=list(h)</span><br><span class="line">    <span class="keyword">if</span> hl[<span class="number">0</span>]==<span class="string">'6'</span>:</span><br><span class="line">        <span class="keyword">if</span> hl[<span class="number">1</span>]==<span class="string">'1'</span>:</span><br><span class="line">            <span class="keyword">if</span> hl[<span class="number">2</span>]==<span class="string">'9'</span>:</span><br><span class="line">                <span class="keyword">if</span> hl[<span class="number">3</span>]==<span class="string">'c'</span>:</span><br><span class="line">                    <span class="keyword">if</span> hl[<span class="number">4</span>]==<span class="string">'2'</span>:</span><br><span class="line">                        <span class="keyword">if</span> hl[<span class="number">5</span>]==<span class="string">'0'</span>:</span><br><span class="line">                            <span class="keyword">if</span> hl[<span class="number">6</span>]==<span class="string">'c'</span>:</span><br><span class="line">                                <span class="keyword">if</span> hl[<span class="number">8</span>]==<span class="string">'a'</span>:</span><br><span class="line">                                    <span class="keyword">if</span> hl[<span class="number">16</span>]==<span class="string">'9'</span>:</span><br><span class="line">                                        <span class="keyword">if</span> hl[<span class="number">24</span>]==<span class="string">'b'</span>:</span><br><span class="line">                                            <span class="keyword">if</span> hl[<span class="number">32</span>]==<span class="string">'e'</span>:</span><br><span class="line">                                                <span class="keyword">print</span> <span class="string">"Find!"</span></span><br><span class="line">                                                <span class="keyword">print</span> <span class="string">"Hash:%s"</span> %h</span><br><span class="line">                                                <span class="keyword">print</span> <span class="string">"Password:%s"</span> %pwd</span><br><span class="line">                                                matched=<span class="number">1</span></span><br><span class="line">                                                <span class="keyword">return</span> matched</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        matched=<span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> matched</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate</span><span class="params">()</span>:</span></span><br><span class="line">    x=range(<span class="number">32</span>,<span class="number">128</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> x:</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> x:</span><br><span class="line">                <span class="keyword">for</span> l <span class="keyword">in</span> x:</span><br><span class="line">                    pwd=chr(i)+<span class="string">'7'</span>+chr(j)+<span class="string">'5-'</span>+chr(k)+<span class="string">'4'</span>+chr(l)+<span class="string">'3?'</span></span><br><span class="line">                    sha1_hash=hashlib.sha1()</span><br><span class="line">                    sha1_hash.update(pwd)</span><br><span class="line">                    h=sha1_hash.hexdigest()</span><br><span class="line">                    matched=match(h,pwd)</span><br><span class="line">                    <span class="keyword">if</span> matched:</span><br><span class="line">                        <span class="keyword">print</span> <span class="string">"congratulation!"</span></span><br><span class="line">                        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="keyword">pass</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    start=time.clock()</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Breaking,please wait!"</span></span><br><span class="line">    generate()</span><br><span class="line">    end=time.clock()</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Used time:%s"</span> %(end-start)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>得到的结果是：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Breaking,please <span class="built_in">wait</span>!        </span><br><span class="line">Find!                            </span><br><span class="line">Hash:619c20c4a4de75519be9a8b7b7cbfa54e8b4365b</span><br><span class="line">Password:I7~5-s4F3?               </span><br><span class="line">congratulation!      </span><br><span class="line">Used time:70.78125</span><br></pre></td></tr></table></figure>
<h3 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h3><p>将easy SHA1解压之后</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Hello World ;-)</span><br><span class="line">MD5校验真的安全吗？</span><br><span class="line">有没有两个不同的程序MD5却相同呢？</span><br><span class="line">如果有的话另一个程序输出是什么呢？</span><br><span class="line">解压密码为单行输出结果。</span><br></pre></td></tr></table></figure>
<p>看到这段文字，说另一个程序输出是什么，不知道思路，网上查查，找到一篇这样的<a href="https://blog.csdn.net/thanklife/article/details/78685255" target="_blank" rel="noopener">blog</a></p>
<p>将其中两个程序下载运行：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#第一个输出</span></span><br><span class="line">Hello World ;-)</span><br><span class="line"><span class="comment">#第二个输出</span></span><br><span class="line">Goodbye World :-(</span><br></pre></td></tr></table></figure>
<p>所以这里的密码应该是<code>Goodbye World :-(</code></p>
<h3 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h3><p>解压后，最后是一个RSA加密：<br>使用<code>openssl</code>查看公钥文件:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">RSA Public-Key: (1026 bit) </span><br><span class="line">Modulus:                       </span><br><span class="line">02:8f:ff:9d:d3:e6:fe:97:81:64:9e:b7:fe:5e:93:    </span><br><span class="line">03:cf:69:63:47:c4:11:0b:c4:ba:39:69:f0:b1:16:  </span><br><span class="line">69:84:0c:51:d8:1a:68:42:b6:df:2b:09:0f:21:<span class="built_in">cd</span>: </span><br><span class="line">76:d4:37:1a:8c:0e:47:04:8c:96:5e:ca:5b:46:91: </span><br><span class="line">3a:fb:b8:da:05:20:72:a0:56:6d:70:39:c6:18:ab: </span><br><span class="line">a9:06:57:59:b0:59:e2:9e:48:5d:c5:06:1a:16:ac:    </span><br><span class="line">63:12:94:38:d9:35:4e:65:df:57:47:54:6b:85:db: </span><br><span class="line">3d:69:98:19:c4:b7:73:2d:f9:27:c7:08:4a:5d:52:  </span><br><span class="line">d6:e6:d6:aa:c1:44:62:34:25                                                                                                             </span><br><span class="line">Exponent:                 </span><br><span class="line">01:f8:fb:a4:10:05:2d:f7:ed:a3:46:2f:1a:ac:d6:     </span><br><span class="line">9e:40:76:04:33:ca:33:57:67:<span class="built_in">cd</span>:73:05:a3:d0:90: </span><br><span class="line">80:5a:5f:d4:05:dd:6e:ea:70:e9:8f:0c:a1:e1:cf:  </span><br><span class="line">25:47:48:67:1b:f0:c9:80:06:c2:0e:ee:1d:62:79: </span><br><span class="line">04:35:09:fe:7a:98:23:8b:43:91:60:a5:61:2d:a7:  </span><br><span class="line">1e:90:45:14:e8:12:80:61:7e:30:7c:3c:d3:31:3f: </span><br><span class="line">a4:c6:<span class="built_in">fc</span>:a3:31:59:d0:44:1f:bb:18:d8:3c:af:4b:</span><br><span class="line">d4:6f:6b:92:97:a8:0a:14:2d:d6:9b:f1:a3:57:cc:   </span><br><span class="line">b5:e4:c2:00:b6:d9:0f:15:a3</span><br><span class="line">Modulus=28FFF9DD3E6FE9781649EB7FE5E9303CF696347C4110BC4BA3969F0B11669840C51D81A6842B6DF2B090F21CD76D4371A8C0E47048C965ECA5B46913AFBB8DA052072A0566D7039C618ABA9065759B059E29E485DC5061A16AC63129438D9354E65DF5747546B85DB3D699819C4B7732DF927C7084A5D52D6E6D6AAC144623425</span><br></pre></td></tr></table></figure>
<p>看的出来，这里需要维纳攻击:</p>
<p>使用rsa-wiener-attack工具求出d,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    #test_is_perfect_square()</span><br><span class="line">    #print(&quot;-------------------------&quot;)</span><br><span class="line">    n = 460657813884289609896372056585544172485318117026246263899744329237492701820627219556007788200590119136173895989001382151536006853823326382892363143604314518686388786002989248800814861248595075326277099645338694977097459168530898776007293695728101976069423971696524237755227187061418202849911479124793990722597</span><br><span class="line">    e = 354611102441307572056572181827925899198345350228753730931089393275463916544456626894245415096107834465778409532373187125318554614722599301791528916212839368121066035541008808261534500586023652767712271625785204280964688004680328300124849680477105302519377370092578107827116821391826210972320377614967547827619</span><br><span class="line">    d = hack_RSA(e,n)</span><br><span class="line">    print(&quot;d=&quot;,d)</span><br></pre></td></tr></table></figure>
<p>得到<code>d = 8264667972294275017293339772371783322168822149471976834221082393409363691895</code></p>
<p>下面就可以直接写解密脚本了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#owner:IFpop</span></span><br><span class="line"><span class="comment">#time:2019/10/29</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line"></span><br><span class="line">n = <span class="number">460657813884289609896372056585544172485318117026246263899744329237492701820627219556007788200590119136173895989001382151536006853823326382892363143604314518686388786002989248800814861248595075326277099645338694977097459168530898776007293695728101976069423971696524237755227187061418202849911479124793990722597</span></span><br><span class="line">d = <span class="number">8264667972294275017293339772371783322168822149471976834221082393409363691895</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'flag.enc'</span>,<span class="string">'rb'</span>)<span class="keyword">as</span> f:</span><br><span class="line">    c = number.bytes_to_long(f.read()) </span><br><span class="line">m = pow(c,d,n)</span><br><span class="line">print(number.long_to_bytes(m))</span><br><span class="line"><span class="comment">#flag&#123;W0rld_Of_Crypt0gr@phy&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="DSA"><a href="#DSA" class="headerlink" title="DSA"></a>DSA</h2><p>关于<code>DSA</code>之前也没怎么接触过，现在遇到，就顺便总结一下</p>
<h3 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h3><h4 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h4><ol>
<li>是Schnorr和ElGamal签名算法的变种，被美国NIST作为数字签名标准</li>
<li>它是另一种公开密钥算法，它不能用作加密，只用作数字签名。</li>
<li>DSA使用公开密钥，为接受者验证数据的完整性和数据发送者的身份。它也可用于由第三方去确定签名和所签数据的真实性。DSA算法的安全性基于解离散对数的困难性，这类签字标准具有较大的兼容性和适用性，成为网络安全体系的基本构件之一。</li>
</ol>
<h4 id="其他知识点"><a href="#其他知识点" class="headerlink" title="其他知识点"></a>其他知识点</h4><p><a href="https://www.jarviswang.me/?p=169" target="_blank" rel="noopener">总结</a></p>
<h3 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h3><blockquote>
<p>DSA是基于整数有限域离散对数难题的，其安全性与RSA相比差不多。DSA的一个重要特点是两个素数公开，这样，当使用别人的p和q时，即使不知道私钥x，你也能确认它们是否是随机产生的，还是作了手脚。</p>
<p>可以使用openssl方便地进行dsa签名和验证。</p>
<p>签名与验证：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; openssl dgst -sha1 -sign dsa_private.pem -out sign.bin message.txt</span><br><span class="line">&gt; openssl sha1 -verify dsa_public.pem -signature sign.bin message.txt</span><br><span class="line">&gt; </span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<p>本题的攻击方法曾被用于PS3的破解，答案格式：CTF{x}(x为私钥，请提交十进制格式)</p>
</blockquote>
<p>下载文件解压，发现里面有着四个<code>packet</code>以及一个公钥</p>
<p>使用上述命令可以验证通过。</p>
<p>其中的<code>message</code>文件可以查看，可以找到一些信息:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#message1</span></span><br><span class="line">Digital Signature Algorithm (DSA)是Schnorr和ElGamal签名算法的变种，被美国NIST作为DSfS(DigitalSignature Standard)。</span><br><span class="line">http://baike.baidu.com/item/DSA%E7%AE%<span class="number">97</span>%E6%B3%<span class="number">95</span></span><br><span class="line"><span class="comment">#message2</span></span><br><span class="line">这里简要介绍了一些asn1结构编码</span><br><span class="line"><span class="comment">#message3</span></span><br><span class="line">介绍了一些openssl</span><br><span class="line"><span class="comment">#message4</span></span><br><span class="line">。。。</span><br></pre></td></tr></table></figure>
<p>查了一下asn1的知识，发现<code>openssl</code>中就存在着asn1parse转码操作，所以以此查看sign.bin中的信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl asn1parse [-inform PEM|DER] [-<span class="keyword">in</span> filename] [-out filename] [-noout] [-offset number] [-length number] [-i] [- structure filename] [-strparse offset]</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> openssl asn1parse -inform der -<span class="keyword">in</span> packet1/sign1.bin </span><br><span class="line">0:d=0  hl=2 l=  45    cons: SEQUENCE </span><br><span class="line">2:d=1  hl=2 l=  21    prim: INTEGER      :8158B477C5AA033D650596E93653C730D26BA409  </span><br><span class="line">25:d=1  hl=2 l=  20   prim: INTEGER      :165B9DD1C93230C31111E5A4E6EB5181F990F702 </span><br><span class="line"></span><br><span class="line">openssl asn1parse -inform der -<span class="keyword">in</span> packet2/sign2.bin         </span><br><span class="line">0:d=0  hl=2 l=  44 cons: SEQUENCE                                      </span><br><span class="line">2:d=1  hl=2 l=  20 prim: INTEGER         :60B9F2A5BA689B802942D667ED5D1EED066C5A7F   </span><br><span class="line">24:d=1  hl=2 l=  20 prim: INTEGER        :3DC8921BA26B514F4D991A85482750E0225A15B5</span><br><span class="line"></span><br><span class="line">openssl asn1parse -inform der -<span class="keyword">in</span> packet3/sign3.bin </span><br><span class="line">0:d=0  hl=2 l=  44 cons: SEQUENCE                                     </span><br><span class="line">2:d=1  hl=2 l=  20 prim: INTEGER         :5090DA81FEDE048D706D80E0AC47701E5A9EF1CC    </span><br><span class="line">24:d=1  hl=2 l=  20 prim: INTEGER        :30EB88E6A4BFB1B16728A974210AE4E41B42677D</span><br><span class="line"></span><br><span class="line">openssl asn1parse -inform der -<span class="keyword">in</span> packet4/sign4.bin     </span><br><span class="line">0:d=0  hl=2 l=  44  cons: SEQUENCE                               </span><br><span class="line">2:d=1  hl=2 l=  20  prim:  INTEGER      :5090DA81FEDE048D706D80E0AC47701E5A9EF1CC  <span class="comment">#r</span></span><br><span class="line">24:d=1  hl=2 l=  20 prim:  INTEGER      :5E10DED084203CCBCEC3356A2CA02FF318FD4123  <span class="comment">#s</span></span><br></pre></td></tr></table></figure>
<script type="math/tex; mode=display">
r = (g^k mod\ p) mod\ q \qquad \qquad \\
s = [k^{-1}*(H(M)+xr)] mod\ q</script><p>由于对多条消息进行数字签名时，k是不变的，所以：</p>
<script type="math/tex; mode=display">
k*s_1 = H(M_1)+xr(mod\ q) \quad (1) \\
k*s_2 = H(M_2)+xr(mod\ p) \quad (2)\\</script><p>由<code>(1)*s2</code>、<code>(2)*s1</code>得：</p>
<script type="math/tex; mode=display">
k*s_1*s_2 = s_2*H(M_1)+s_2*xr(mod\ q) \\
k*s_2*s_1 = s_1*H(M_2)+s_1*xr(mod\ q)</script><p>最终可以解得:</p>
<script type="math/tex; mode=display">
x = [s_2*H(M_1)-s_1*H(M_2)]（s_1*r-s_2*r）^{-1} mod\ q</script><p>而上面的分析可以发现，只有packet3和packet4的r是相同的，所以脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> DSA</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'dsa_public.pem'</span>,<span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    key = DSA.importKey(f.read())</span><br><span class="line">    y = key.y</span><br><span class="line">    g = key.g</span><br><span class="line">    p = key.p</span><br><span class="line">    q = key.q</span><br><span class="line">f3 = open(<span class="string">"packet3/message3"</span>, <span class="string">'rb'</span>)</span><br><span class="line">f4 = open(<span class="string">"packet4/message4"</span>, <span class="string">'rb'</span>)</span><br><span class="line">data3 = f3.read()</span><br><span class="line">data4 = f4.read()</span><br><span class="line">sha = sha1()</span><br><span class="line">sha.update(data3)</span><br><span class="line">m3 = int(sha.hexdigest(), <span class="number">16</span>)</span><br><span class="line">sha = sha1()</span><br><span class="line">sha.update(data4)</span><br><span class="line">m4 = int(sha.hexdigest(), <span class="number">16</span>)</span><br><span class="line">s3 = <span class="number">0x30EB88E6A4BFB1B16728A974210AE4E41B42677D</span></span><br><span class="line">s4 = <span class="number">0x5E10DED084203CCBCEC3356A2CA02FF318FD4123</span></span><br><span class="line">r = <span class="number">0x5090DA81FEDE048D706D80E0AC47701E5A9EF1CC</span></span><br><span class="line"></span><br><span class="line">x = ((s4*m3-s3*m4)*gmpy2.invert(s3*r-s4*r,q))%q</span><br><span class="line">print(x)</span><br><span class="line"><span class="comment">#520793588153805320783422521615148687785086070744</span></span><br></pre></td></tr></table></figure>
<p>所以<code>CTF{520793588153805320783422521615148687785086070744}</code></p>
<h2 id="vigenere-1"><a href="#vigenere-1" class="headerlink" title="vigenere"></a>vigenere</h2><p>这题要使用kriski测试法，太麻烦了，直接上<a href="http://73spica.tech/blog/tw_mma_ctf_2016_vigenere-cipher/" target="_blank" rel="noopener">大佬程序</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!usr/env/python</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#owner: IFpop</span></span><br><span class="line"><span class="comment">#time: 2910/11/2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode, b64decode</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> fractions <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</span><br><span class="line"> </span><br><span class="line">candi_count = <span class="number">0</span></span><br><span class="line">chars = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/'</span></span><br><span class="line">encrypted = <span class="string">"a7TFeCShtf94+t5quSA5ZBn4+3tqLTl0EvoMsNxeeCm50Xoet+1fvy821r6Fe4fpeAw1ZB+as3Tphe8xZXQ/s3tbJy8BDzX4vN5svYqIZ96rt35dKuz0DfCPf4nfKe300fM9utiauTe5tgs5utLpLTh0FzYx0O1sJYKgJvul0OfiuTl00BCks+aaJZm8Kwb4u+LtLCqbZ96lv3bieCahtegx+7nzqyO6YCb4b9LovCELZ9Pe0L5rLSaBDzXaftxseAw1JzCF0MGjeCacKb69u9TlgCudZT6Os3ojhcWxD914vNHfeCuaJvH4s4aarBKlGdsT8G4UKZhfJB+y0LbjqCOnZT6baF1WiZeNtfsNtuoo+c=="</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shift</span><span class="params">(char, key, rev = False)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> char <span class="keyword">in</span> chars:</span><br><span class="line">        <span class="keyword">return</span> char</span><br><span class="line">    <span class="keyword">if</span> rev:</span><br><span class="line">        <span class="keyword">return</span> chars[(chars.index(char) - chars.index(key)) % len(chars)]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print((chars.index(char) + chars.index(key)) % len(chars))</span><br><span class="line">        <span class="keyword">return</span> chars[(chars.index(char) + chars.index(key)) % len(chars)]</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(message, key)</span>:</span></span><br><span class="line">    encrypted = b64encode(message.encode(<span class="string">'ascii'</span>)).decode(<span class="string">'ascii'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join([shift(encrypted[i], key[i % len(key)]) <span class="keyword">for</span> i <span class="keyword">in</span> range(len(encrypted))])</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">original_decrypt</span><span class="params">(encrypted, key)</span>:</span></span><br><span class="line">    encrypted = <span class="string">''</span>.join([shift(encrypted[i], key[i % len(key)], <span class="literal">True</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(len(encrypted))])</span><br><span class="line">    <span class="keyword">return</span> b64decode(encrypted.encode(<span class="string">'ascii'</span>)).decode(<span class="string">'ascii'</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># not using encode or decode ascii</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(encrypted, key)</span>:</span></span><br><span class="line">    encrypted = <span class="string">''</span>.join([shift(encrypted[i], key[i % len(key)], <span class="literal">True</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(len(encrypted))])</span><br><span class="line">    <span class="keyword">return</span> b64decode(encrypted)</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_random_key</span><span class="params">(length = <span class="number">5</span>)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(map(<span class="keyword">lambda</span> a : chars[a % len(chars)], os.urandom(length)))</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Kasiski_exam</span><span class="params">(encrypted)</span>:</span></span><br><span class="line">    strlist = []</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    indexlist = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(encrypted)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i,len(encrypted)):</span><br><span class="line">            <span class="keyword">if</span> j-i&lt;<span class="number">3</span>:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">            start = i</span><br><span class="line">            search_str = encrypted[i:j]</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                detect = encrypted[start:].find(search_str)</span><br><span class="line">                <span class="keyword">if</span> detect == <span class="number">-1</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    count+=<span class="number">1</span></span><br><span class="line">                    <span class="keyword">if</span> count==<span class="number">2</span>:</span><br><span class="line">                        strlist.append(search_str)</span><br><span class="line">                        indexlist.append(detect+j-i)</span><br><span class="line">                    start += detect+(j-i)</span><br><span class="line">            <span class="keyword">if</span> count==<span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            count=<span class="number">0</span></span><br><span class="line">    print(indexlist)</span><br><span class="line">    print(strlist)</span><br><span class="line">    anslist = my_factor(indexlist)</span><br><span class="line">    <span class="keyword">return</span> anslist</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_factor</span><span class="params">(numlist)</span>:</span></span><br><span class="line">    factor_list = []</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">2</span>,int(sqrt(numlist[<span class="number">0</span>]))+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> numlist[<span class="number">0</span>]%x == <span class="number">0</span> <span class="keyword">and</span> x&gt;=<span class="number">5</span> <span class="keyword">and</span> x&lt;=<span class="number">14</span>:</span><br><span class="line">            factor_list.append(x)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,len(numlist)):</span><br><span class="line">        anslist = list(factor_list)</span><br><span class="line">        num = numlist[i]</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> factor_list:</span><br><span class="line">            <span class="keyword">if</span> num%x !=<span class="number">0</span>:</span><br><span class="line">                anslist.remove(x)</span><br><span class="line">    <span class="keyword">return</span> anslist</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_ascii</span><span class="params">(string)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> string:</span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> string:</span><br><span class="line">            <span class="keyword">if</span>  char &gt; <span class="number">126</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">if</span> char&lt;<span class="number">32</span> <span class="keyword">and</span> <span class="keyword">not</span> char==<span class="number">10</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">split_str_and_isascii</span><span class="params">(plain,num,block)</span>:</span></span><br><span class="line">    start = <span class="number">3</span>*block</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(start,len(plain),<span class="number">9</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> is_ascii(plain[i:i+num]):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># if key_len == 12</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">brute_key</span><span class="params">(encrypted,key_len)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> candi_count</span><br><span class="line">    candi_key_list = [[],[],[]]</span><br><span class="line">    <span class="keyword">for</span> block <span class="keyword">in</span> range(int(key_len/<span class="number">4</span>)):</span><br><span class="line">        <span class="keyword">for</span> a <span class="keyword">in</span> chars:</span><br><span class="line">            <span class="keyword">for</span> b <span class="keyword">in</span> chars:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> split_str_and_isascii(decrypt(encrypted,a+b+<span class="string">"aa"</span>),<span class="number">1</span>,block):</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> chars:</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> split_str_and_isascii(decrypt(encrypted,a+b+c+<span class="string">"a"</span>),<span class="number">2</span>,block):</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    <span class="keyword">for</span> d <span class="keyword">in</span> chars:</span><br><span class="line">                        <span class="keyword">if</span> split_str_and_isascii(decrypt(encrypted,a+b+c+d),<span class="number">3</span>,block):</span><br><span class="line">                            candi_key_list[block].append(a+b+c+d)</span><br><span class="line">                            candi_count+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> candi_key_list</span><br><span class="line"> </span><br><span class="line"><span class="comment">#if key_len == 6</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">brute_key_6</span><span class="params">(encrypted,key_len)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> candi_count</span><br><span class="line">    candi_key_list = []</span><br><span class="line">    <span class="keyword">for</span> block <span class="keyword">in</span> range(int(key_len/<span class="number">4</span>)):</span><br><span class="line">        <span class="keyword">for</span> a <span class="keyword">in</span> chars:</span><br><span class="line">            <span class="keyword">for</span> b <span class="keyword">in</span> chars:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> split_str_and_isascii(decrypt(encrypted,a+b+<span class="string">"aa"</span>),<span class="number">1</span>,block):</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> chars:</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> split_str_and_isascii(decrypt(encrypted,a+b+c+<span class="string">"a"</span>),<span class="number">2</span>,block):</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    <span class="keyword">for</span> d <span class="keyword">in</span> chars:</span><br><span class="line">                        <span class="keyword">if</span> split_str_and_isascii(decrypt(encrypted,a+b+c+d),<span class="number">3</span>,block):</span><br><span class="line">                            candi_key_list.append(a+b+c+d)</span><br><span class="line">                            candi_count+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> candi_key_list</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># ==== kasiski examination ====</span></span><br><span class="line">    factor_list = Kasiski_exam(encrypted) <span class="comment"># [6,12]</span></span><br><span class="line">    key_len = factor_list[<span class="number">1</span>]</span><br><span class="line">    <span class="comment"># ==== brute force attack to base64 ====</span></span><br><span class="line">    print(<span class="string">"Start brute force..."</span>)</span><br><span class="line">    candi_key1,candi_key2,candi_key3 = brute_key(encrypted,key_len)</span><br><span class="line">    print(candi_key1)</span><br><span class="line">    print(candi_key2)</span><br><span class="line">    print(candi_key3)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># ==== key candidate ====</span></span><br><span class="line">    keylist = []</span><br><span class="line">    <span class="keyword">for</span> key1 <span class="keyword">in</span> candi_key1:</span><br><span class="line">        <span class="keyword">for</span> key2 <span class="keyword">in</span> candi_key2:</span><br><span class="line">            <span class="keyword">for</span> key3 <span class="keyword">in</span> candi_key3:</span><br><span class="line">                keylist.append(key1+key2+key3)</span><br><span class="line">    print(candi_count)</span><br><span class="line">    print(keylist)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># if "TWCTF&#123;" in decrypted, It is highly possible that the key is correct.</span></span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> keylist:</span><br><span class="line">        dec = decrypt(encrypted,key)</span><br><span class="line">        check = <span class="string">b"TWCTF&#123;"</span></span><br><span class="line">        <span class="keyword">if</span> check <span class="keyword">in</span> dec:</span><br><span class="line">            print(<span class="string">"--------- key candidate : decrypted ---------------"</span>)</span><br><span class="line">            print(key,<span class="string">":"</span>,dec)</span><br><span class="line">            print()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br><span class="line"><span class="comment">#TWCTF&#123;C14ss1caL CiPhEr iS v3ry fun&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="superexpress"><a href="#superexpress" class="headerlink" title="superexpress"></a>superexpress</h2><p>下载下来两个文件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#problem.py</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">key = <span class="string">'****CENSORED***************'</span></span><br><span class="line">flag = <span class="string">'TWCTF&#123;*******CENSORED********&#125;'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(key) % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">    print(<span class="string">"Key Length Error"</span>)</span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">n = len(key) / <span class="number">2</span></span><br><span class="line">encrypted = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> flag:</span><br><span class="line">    c = ord(c)</span><br><span class="line">    <span class="keyword">for</span> a, b <span class="keyword">in</span> zip(key[<span class="number">0</span>:n], key[n:<span class="number">2</span>*n]): <span class="comment">#关于zip函数可以自己查一下</span></span><br><span class="line">        c = (ord(a) * c + ord(b)) % <span class="number">251</span></span><br><span class="line">    encrypted += <span class="string">'%02x'</span> % c</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> encrypted</span><br><span class="line"><span class="comment">#enc 805eed80cbbccb94c36413275780ec94a857dfec8da8ca94a8c313a8ccf9</span></span><br></pre></td></tr></table></figure>
<p>由于最后的结果会模上251，所以key的所有字母的ASCII一定在251以内且长度为偶数，脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!usr/env/python3</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#owner: IFpop</span></span><br><span class="line"><span class="comment">#time: 2019/10/31</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="comment">#由于flag的开头是TWCTF&#123;&#125;,而a,b一定会在251以内，所以可以将a,b爆破出来</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_key</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> range(<span class="number">251</span>):</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> range(<span class="number">251</span>):</span><br><span class="line">            <span class="keyword">if</span> (ord(<span class="string">"T"</span>) * a + b) % <span class="number">251</span> == int_enc[<span class="number">0</span>] <span class="keyword">and</span> (ord(<span class="string">"W"</span>) * a + b) % <span class="number">251</span> == int_enc[<span class="number">1</span>] <span class="keyword">and</span> (ord(<span class="string">"C"</span>) * a + b) % <span class="number">251</span> == int_enc[<span class="number">2</span>]:</span><br><span class="line">                <span class="keyword">return</span> a, b</span><br><span class="line"></span><br><span class="line">enc = <span class="string">"805eed80cbbccb94c36413275780ec94a857dfec8da8ca94a8c313a8ccf9"</span></span><br><span class="line">int_enc = []</span><br><span class="line"><span class="comment">#将上面密文转化成10进制</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(enc), <span class="number">2</span>):</span><br><span class="line">    int_enc += [int(enc[i:i + <span class="number">2</span>], <span class="number">16</span>)]</span><br><span class="line"></span><br><span class="line">a,b = find_key()</span><br><span class="line"><span class="comment">#生成所有可打印字符</span></span><br><span class="line">chars = string.printable</span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> int_enc:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> chars:</span><br><span class="line">        <span class="keyword">if</span> (ord(j)*a+b)%<span class="number">251</span> == i:</span><br><span class="line">            flag += j</span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment">#TWCTF&#123;Faster_Than_Shinkansen!&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="好多盐"><a href="#好多盐" class="headerlink" title="好多盐"></a>好多盐</h2><blockquote>
<p>某遗留系统采用固定格式+6-10位数字类型密码，今天他们发生了数据泄露事件，已知固定格式为{FLAG:}，做为一名黑客，你要开始干活了。字符串长度为10位</p>
</blockquote>
<p>题目给了很多hash过的文件，以及盐，关于这方面的概念可以自行百度<code>md5</code>与盐的相关知识，直接爆破就行:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!usr/env/python3</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#owner: IFpop</span></span><br><span class="line"><span class="comment">#time: 2019/11/1</span></span><br><span class="line"><span class="comment">#!usr/env/python3</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#owner: IFpop</span></span><br><span class="line"><span class="comment">#time: 2019/11/1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> MD5</span><br><span class="line"></span><br><span class="line">password = <span class="string">'''f09ebdb2bb9f5eb4fbd12aad96e1e929 p5Zg6LtD</span></span><br><span class="line"><span class="string"> 6cea25448314ddb70d98708553fc0928 ZwbWnG0j</span></span><br><span class="line"><span class="string"> 2629906b029983a7c524114c2dd9cc36 1JE25XOn</span></span><br><span class="line"><span class="string"> 2e854eb55586dc58e6758cfed62dd865 ICKTxe5j</span></span><br><span class="line"><span class="string"> 7b073411ee21fcaf177972c1a644f403 0wdRCo1W</span></span><br><span class="line"><span class="string"> 6795d1be7c63f30935273d9eb32c73e3 EuMN5GaH</span></span><br><span class="line"><span class="string"> d10f5340214309e3cfc00bbc7a2fa718 aOrND9AB</span></span><br><span class="line"><span class="string"> 8e0dc02301debcc965ee04c7f5b5188b uQg6JMcx</span></span><br><span class="line"><span class="string"> 4fec71840818d02f0603440466a892c9 XY5QnHmU</span></span><br><span class="line"><span class="string"> ee8f46142f3b5d973a01079f7b47e81c zMVNlHOr</span></span><br><span class="line"><span class="string"> e4d9e1e85f3880aedb7264054acd1896 TqRhn1Yp</span></span><br><span class="line"><span class="string"> 0fd046d8ecddefc66203f6539cac486b AR5lI2He</span></span><br><span class="line"><span class="string"> f6326f02adaa31a66ed06ceab2948d01 Aax2fIPl</span></span><br><span class="line"><span class="string"> 720ba10d446a337d79f1da8926835a49 ZAOYDPR2</span></span><br><span class="line"><span class="string"> 06af8bcc454229fe5ca09567a9071e62 hvcECKYs</span></span><br><span class="line"><span class="string"> 79f58ca7a81ae2775c2c2b73beff8644 TgFacoR3</span></span><br><span class="line"><span class="string"> 46aaa5a7fef5e250a2448a8d1257e9cf GLYu0NO4</span></span><br><span class="line"><span class="string"> 2149ac87790dd0fe1b43f40d527e425a 5Xk2O1sG</span></span><br><span class="line"><span class="string"> d15a36d8be574ac8fe64689c728c268e aZikhUEy</span></span><br><span class="line"><span class="string"> ff7bced91bd9067834e3ad14cc1464cd E7UROqXn</span></span><br><span class="line"><span class="string"> 8cc0437187caf10e5eda345cb6296252 XPin3mVB</span></span><br><span class="line"><span class="string"> 5cfcdca4a9cb2985a0b688406617689e nsGqoafv</span></span><br><span class="line"><span class="string"> 5a7dfa8bc7b5dfbb914c0a78ab2760c6 YC1qZUFR</span></span><br><span class="line"><span class="string"> 8061d8f222167fcc66569f6261ddd3cc wNgQi615</span></span><br><span class="line"><span class="string"> 3d8a02528c949df7405f0b48afe4a626 CO2NMusb</span></span><br><span class="line"><span class="string"> 70651acbc8bd027529bbcccdbf3b0f14 CAXVjFMd</span></span><br><span class="line"><span class="string"> a9dbe70e83596f2d9210970236bdd535 TL6sjEuK</span></span><br><span class="line"><span class="string"> 9ed6ef5780f705ade6845b9ef349eb8f tJ90ibsz</span></span><br><span class="line"><span class="string"> 4b46fac0c41b0c6244523612a6c7ac4a VTjOSNmw</span></span><br><span class="line"><span class="string"> 8141e6ecb4f803426d1db8fbeb5686ef lh75cdNC</span></span><br><span class="line"><span class="string"> df803949fd13f5f7d7dd8457a673104b V39sEvYX</span></span><br><span class="line"><span class="string"> 19052cc5ef69f90094753c2b3bbcd41d YwoGExpg</span></span><br><span class="line"><span class="string"> cf8591bdccfaa0cdca652f1d31dbd70f pJCLui49</span></span><br><span class="line"><span class="string"> 66e10e3d4a788c335282f42b92c760a1 NQCZoIhj</span></span><br><span class="line"><span class="string"> 94c3ae5bcc04c38053106916f9b99bda vOktelLQ</span></span><br><span class="line"><span class="string"> e67e88646758e465697c15b1ef164a8d x0hwJGHj</span></span><br><span class="line"><span class="string"> 84d3d828e1a0c14b5b095bedc23269fb 2HVWe9fM</span></span><br><span class="line"><span class="string"> 264a9e831c3401c38021ba3844479c3f Cx4og6IW</span></span><br><span class="line"><span class="string"> ed0343dec184d9d2c30a9b9c1c308356 g2rqmPkT</span></span><br><span class="line"><span class="string"> ad5ba8dc801c37037350578630783d80 pFK2JDT5</span></span><br><span class="line"><span class="string"> 3f588bedb704da9448e68fe81e42bca6 4ANDOiau</span></span><br><span class="line"><span class="string"> 970c9cf3cad3dfa7926f53ccaae89421 R6ML7Qy8</span></span><br><span class="line"><span class="string"> e0a097b7cceaa7a8949fe039884e4a2d dul2ynqL</span></span><br><span class="line"><span class="string"> 7df505218102c64b1fe4fa5981ddb6fa jPeoyS57</span></span><br><span class="line"><span class="string"> fd4f6043da1f7d5dca993c946ef6cd7c 6p9CwGaY</span></span><br><span class="line"><span class="string"> 5fe6d99b9a2824949279187c246c9c30 OGQ2J57y</span></span><br><span class="line"><span class="string"> 135b150ad513a961089bb1c05085a3d9 h0dw1Fro</span></span><br><span class="line"><span class="string"> ad6af4fb623b3c51181a371911667fed HbQT4dRz</span></span><br><span class="line"><span class="string"> c9fa4b0db317d88e2b10060225e92494 ebVnpMzS</span></span><br><span class="line"><span class="string"> d0deab17d115bd6fdce8592bb3667643 bL5zwgvX</span></span><br><span class="line"><span class="string"> 006f0cb3a422716692f143f28eb0d187 NHXg1Fof</span></span><br><span class="line"><span class="string"> ddc125de34da1a6ec0cbe401f147bc8f GDai9Y0n</span></span><br><span class="line"><span class="string"> be5052053c5a806e8f56ed64e0d67821 40alyH3w</span></span><br><span class="line"><span class="string"> aaf18ac446b8c385c4112c10ae87e7dc ZJQzuIL0</span></span><br><span class="line"><span class="string"> a2db20a4b7386dc2d8c30bf9a05ceef7 QnpOlPWH</span></span><br><span class="line"><span class="string"> 8a4fbc32a3251bb51072d51969ba5d33 rtcbipeq</span></span><br><span class="line"><span class="string"> 5e35d2c9675ed811880cea01f268e00f i1Hbne6h</span></span><br><span class="line"><span class="string"> 9da23007699e832f4e9344057c5e0bd3 EtbGpMSW</span></span><br><span class="line"><span class="string"> f09233683d05171420f963fc92764e84 fxHoinEe</span></span><br><span class="line"><span class="string"> 4feabf309c5872f3cca7295b3577f2a8 KymkJXqA</span></span><br><span class="line"><span class="string"> 9b94da2fa9402a3fdb4ff15b9f3ba4d2 G3Tdr1Pg</span></span><br><span class="line"><span class="string"> b3cd8d6b53702d733ba515dec1d770c5 Y71LJWZz</span></span><br><span class="line"><span class="string"> 6a5b3b2526bb7e94209c487585034534 rIwb4oxt</span></span><br><span class="line"><span class="string"> e9728ef776144c25ba0155a0faab2526 e1sOXSb8</span></span><br><span class="line"><span class="string"> d41a5e7a98e28d76dbd183df7e3bcb49 36bedvia</span></span><br><span class="line"><span class="string"> 81d5ebfea6aff129cf515d4e0e5f8360 dDG4qTjW'''</span></span><br><span class="line"></span><br><span class="line">password = password.split(<span class="string">'\n'</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> password:</span><br><span class="line">        print(i)</span><br><span class="line">        pass_md5 = i.split(<span class="string">' '</span>)[<span class="number">0</span>]</span><br><span class="line">        salt = i.split(<span class="string">' '</span>)[<span class="number">1</span>]</span><br><span class="line">        <span class="comment">#由于有着6-10位数字</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">100000</span>,<span class="number">10000000000</span>):</span><br><span class="line">            print(j)</span><br><span class="line">            md5 = MD5.new()</span><br><span class="line">            temp = <span class="string">'&#123;FLAG:'</span>+str(j).zfill(<span class="number">10</span>)+<span class="string">'&#125;'</span>+salt</span><br><span class="line">            temp = bytes(temp,encoding=<span class="string">"utf-8"</span>)</span><br><span class="line">            md5.update(temp)</span><br><span class="line">            <span class="keyword">if</span> md5.hexdigest() == pass_md5:</span><br><span class="line">                print(j)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">solve()</span><br><span class="line"><span class="comment">#1234567890</span></span><br></pre></td></tr></table></figure>
<h2 id="影之密码"><a href="#影之密码" class="headerlink" title="影之密码"></a>影之密码</h2><blockquote>
<p>请分析下列密文进行解密 8842101220480224404014224202480122 得到flag，flag为8位大写字母</p>
</blockquote>
<p><strong>分析</strong>：</p>
<ol>
<li><code>flag</code>是8位大写字母</li>
<li>有7个0，正好分成8段</li>
<li>每段中仅有1，2，4，8，全是2的幂数</li>
<li>查询有关2^n的加密方式，<a href="https://baike.baidu.com/item/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%B9%82%E6%95%B0%E5%8A%A0%E5%AF%86%E6%B3%95/2410151?fr=aladdin" target="_blank" rel="noopener">二进制幂数加密法</a></li>
<li>这里与实际上的二进制幂数加密还是稍微有些区别，8 -– 3 但是这里直接给出，最后解密的结果其实就是将其相加，转成ASCII</li>
</ol>
<p><strong>解密</strong>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!usr/env/python3</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#owner:IFpop</span></span><br><span class="line"></span><br><span class="line">enc = <span class="string">'8842101220480224404014224202480122'</span></span><br><span class="line">enc = enc.split(<span class="string">'0'</span>)</span><br><span class="line">print(enc)</span><br><span class="line">ans = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc:</span><br><span class="line">    temp = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">        temp += int(j)</span><br><span class="line">    ans += chr(ord(<span class="string">'A'</span>)+temp<span class="number">-1</span>)</span><br><span class="line">print(ans)</span><br><span class="line"><span class="comment">#WELLDONE</span></span><br></pre></td></tr></table></figure>
<h2 id="Jarvis’s-encryption-system"><a href="#Jarvis’s-encryption-system" class="headerlink" title="Jarvis’s encryption system"></a>Jarvis’s encryption system</h2><blockquote>
<p>Let’s play with Jarvis’s new encryption box.</p>
<p><strong>nc pwn.jarvisoj.com 9880</strong></p>
</blockquote>
<p>下载下来有两个附件：一个是crypto500.py，一个有关加密过程的图片(就不放上来了)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">key = RSA.importKey(open(<span class="string">'private.pem'</span>).read())</span><br><span class="line">N = <span class="number">808637320166213096433765975908829772554859069394497436792703828416763985949910999652518305818627321094257781267795371106923808192073932662313603219525599014635435542122940843344921727149256852355110338886574805360544004118210641173633231100848831019159519744863314748281129830905559513810272933968408858616937223539622595750248885831720830102914499513408356858587797522763592193335162884129664298938995394243273615798207065590802899685489088903478734288977143851327400816886878238915788561611104380001569848016035186213716602462262685777960742683591155978590371074585063550419528377002596163321548052257322263024813745933243795081592986850478573362522245788630785664119935566422559659277401321793012274415007906726880710258434953224297253000176721652344571059040066987969691706315602374506498087282531643212970147526356421919309049062439117990930204486012562031589114880474346559407445496718773030816258262150397230280669274725009415653773469037623986165899557423095323109994543129373149980880777219450714265152054529287453826506032747047856303879606356141420416161004589629524370677871918513405209191951229311529443558187652701599377904802383252318582028816524498306240682160249309341335405511246150908708558397938689907425750101507</span></span><br><span class="line">p = key.p</span><br><span class="line">q = key.q</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(m, e)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> pow(m, e, N)	</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="keyword">print</span> <span class="string">'Welcome to Jarvis\'s encryption system.Let\'s init the cipher first:'</span></span><br><span class="line">	<span class="keyword">print</span> <span class="string">"e:"</span>,</span><br><span class="line">	e = int(raw_input().strip())</span><br><span class="line">	d = gmpy2.invert(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">	<span class="keyword">print</span> <span class="string">"d: %d"</span> % d</span><br><span class="line">	</span><br><span class="line">	cnt = <span class="number">0</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		cnt += <span class="number">1</span></span><br><span class="line">		<span class="keyword">print</span> <span class="string">"m%d:"</span> % cnt,</span><br><span class="line">		m = int(raw_input().strip())</span><br><span class="line">		c = encrypt(m, e)</span><br><span class="line">		<span class="keyword">print</span> <span class="string">"c%d: %d"</span> % (cnt, c)</span><br><span class="line">		<span class="keyword">print</span> <span class="string">''</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>
<p>使用上述nc命令进行访问，键入e值，会返回d值。</p>
<ol>
<li><p>先把图片中的信息提取出来(用winhex查看末尾就行)</p>
</li>
<li><p>通过已知的明文、密文对e进行爆破</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#usr/env/python3</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#owner: IFpop</span></span><br><span class="line"><span class="comment">#time: 2019/11/5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line"></span><br><span class="line">n = <span class="number">808637320166213096433765975908829772554859069394497436792703828416763985949910999652518305818627321094257781267795371106923808192073932662313603219525599014635435542122940843344921727149256852355110338886574805360544004118210641173633231100848831019159519744863314748281129830905559513810272933968408858616937223539622595750248885831720830102914499513408356858587797522763592193335162884129664298938995394243273615798207065590802899685489088903478734288977143851327400816886878238915788561611104380001569848016035186213716602462262685777960742683591155978590371074585063550419528377002596163321548052257322263024813745933243795081592986850478573362522245788630785664119935566422559659277401321793012274415007906726880710258434953224297253000176721652344571059040066987969691706315602374506498087282531643212970147526356421919309049062439117990930204486012562031589114880474346559407445496718773030816258262150397230280669274725009415653773469037623986165899557423095323109994543129373149980880777219450714265152054529287453826506032747047856303879606356141420416161004589629524370677871918513405209191951229311529443558187652701599377904802383252318582028816524498306240682160249309341335405511246150908708558397938689907425750101507</span></span><br><span class="line">m1 = <span class="number">89372489723987498237894327984372</span></span><br><span class="line">c1 = <span class="number">792279062886162218096642776664224514933347584486280723004734021586336212749049858600481963227286459323970478541843083793725468708921717787221937249530784012084036132167698694870670989692185525559265359595824727956010042190235432643115112280623082788133230708728369892499755238276075667536752879449115011933006031581738186877618805996280847737363426887886868682686959858371130406926178828888575004380515988821399247906070333132810952695798429265793849588130806947806841034544612000197604854503195512120025729616966658790540157838337703936086683817085220432748606686965902101050255048796382841321391071407100767404596588780879740560771450534303617347553555472893929700798373187625224545676303975128589469709553887522697982505366205159178754377849727155295773459020853899833570753142832536760229326028534739725856990225488803963836214548294423502322319111713836053680359093114158912017408230992904911531693795674356749450578360594750306010644345865018135713049088702085668117922755659876667178408188245170381487842104129405699987082399408416605832498886309106565903612880735897179022046135207448286905927468981921408174446350113407999312543013150441972687118445672308468055301677455644948365453703227341347327118261153884632046860369729</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">1</span> </span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    print(e)</span><br><span class="line">    c = pow(m1,e,n)</span><br><span class="line">    <span class="keyword">if</span> c == c1:</span><br><span class="line">        <span class="comment">#7845741   跑了很久，希望之后能找到更快的方法</span></span><br><span class="line">        print(<span class="string">"done!"</span>)</span><br><span class="line">        print(e)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    e = e + <span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>利用<code>nc</code>访问链接，得到d</p>
</li>
<li><p>解密就行：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#usr/env/python3</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#owner: IFpop</span></span><br><span class="line"><span class="comment">#time: 2019/11/5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line"></span><br><span class="line">d = <span class="number">624460328909915360701402168639641282028094468418961878947574807290638891758678991143435088653980701535371225162050430031333639072505365342535152293096454464491608234713910040741806054032872119204341656042243036836513731486079394171780995659012791615808025872985542653518800484827924355387767430294123689221121329057758535673622344148467540232245253256875196052350040448617224502051601181938246394036842235391465615724331125440683500889291172253639404968619326290436776700446299000007994603663440301337649478949521483497552296109838827309290662620012954396232530653067994746179325738761837228276717554780296018709380622306541045859622715377902354561164951333797443088787938481179135106105790091663516291819506679417163921126064227724274720567814644923715786512409941352289194976639518315198223889636540907899742620702027181209723760906029440110133038012652837512150214031930229627563605747245442722777826347211476418833664939434587222857079580932195626606642019627685477852118740507133047312988551945249158637120933025247874896831420739652406553559282198158772718455703088272187706565621125165787151495212884395636011063049499722644316616892917352706474956487897928799493388647214180485284836266930315584778253034297866155428036121429</span></span><br><span class="line">n = <span class="number">808637320166213096433765975908829772554859069394497436792703828416763985949910999652518305818627321094257781267795371106923808192073932662313603219525599014635435542122940843344921727149256852355110338886574805360544004118210641173633231100848831019159519744863314748281129830905559513810272933968408858616937223539622595750248885831720830102914499513408356858587797522763592193335162884129664298938995394243273615798207065590802899685489088903478734288977143851327400816886878238915788561611104380001569848016035186213716602462262685777960742683591155978590371074585063550419528377002596163321548052257322263024813745933243795081592986850478573362522245788630785664119935566422559659277401321793012274415007906726880710258434953224297253000176721652344571059040066987969691706315602374506498087282531643212970147526356421919309049062439117990930204486012562031589114880474346559407445496718773030816258262150397230280669274725009415653773469037623986165899557423095323109994543129373149980880777219450714265152054529287453826506032747047856303879606356141420416161004589629524370677871918513405209191951229311529443558187652701599377904802383252318582028816524498306240682160249309341335405511246150908708558397938689907425750101507</span></span><br><span class="line">c = <span class="number">738822002752800877524466308025949155169562722946933006009883884249589602039677687891359871510923927357766748131398443497541198900771818831638644263405425815579383553019562159083788644122365536627592737115316351290153544908592280731090451811311680698586032725090719266003369555867584457372823678746133588560994163232730766388456903527206840527304843529539480355012405496730615078972755415860013097394363116913629756292725693596880188792245847698225435105827398989245800248197290718407831242734331874121327502564673597694670795036098967372950089253263743880807024448724715652660602771818683520844873803372738417012436219777372987997036211306992938395670636075660990930360358970016244484405618827909229400111542660072678812089441010001235353317911131109787281238112284352067511452432985149442969693926797740772628154057474332702139775407456229918917403138849681496015981718513476254353617586634306067889050783266988506871489696817574207289110594169371818597141857443042841485880477066344316648550850088971005108756497748568090122624591451915965314486079436499049418137147522360690326710468200339550170216543240318289067712843687012174036874897324652429812609807952220427326987655148639613323665786093803557065570465270944069296977739085</span></span><br><span class="line">m = pow(c,d,n)</span><br><span class="line">print(number.long_to_bytes(m))</span><br><span class="line"><span class="comment">#USTCTF&#123;U_r_real33y_m4st3r_0f_math&#125;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="神秘压缩包"><a href="#神秘压缩包" class="headerlink" title="神秘压缩包"></a>神秘压缩包</h2><blockquote>
<p>就不告诉你密码，看你怎么办。</p>
</blockquote>
<p>下载下来一个rar压缩包，一般rar是不会存在伪加密的(至少目前没有遇到过)，尝试爆破，发现时间太长，不太行。</p>
<p>剩下就是尝试一个crc32爆破了(方法同Complicated Crypto)，这里尝试5位</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> crc32_util <span class="keyword">import</span> *</span><br><span class="line">crc = [<span class="number">0x20AE9F17</span>,</span><br><span class="line">       <span class="number">0xD2D0067E</span>,</span><br><span class="line">       <span class="number">0x6C53518D</span>,</span><br><span class="line">       <span class="number">0x80DF4DC3</span>,</span><br><span class="line">       <span class="number">0x3F637A50</span>,</span><br><span class="line">       <span class="number">0xBCD97038</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> crc:</span><br><span class="line">    crc32_reverse(i, <span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<p>得到结果：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">verification checksum: 0x20ae9f17 (OK)</span><br><span class="line">[find]: l./rc (OK)</span><br><span class="line">[find]: passw (OK)</span><br><span class="line">verification checksum: 0xd2d0067e (OK)</span><br><span class="line">[find]: <span class="string">"_YWn (OK)</span></span><br><span class="line"><span class="string">[find]: N,tS* (OK)</span></span><br><span class="line"><span class="string">[find]: Rc(R&gt; (OK)</span></span><br><span class="line"><span class="string">[find]: ord:f (OK) </span></span><br><span class="line"><span class="string">[find]: s=8;r (OK)</span></span><br><span class="line"><span class="string">verification checksum: 0x6c53518d (OK)</span></span><br><span class="line"><span class="string">[find]: /8LWp (OK)</span></span><br><span class="line"><span class="string">[find]: CKaS4 (OK)</span></span><br><span class="line"><span class="string">[find]: ~Z-;l (OK) </span></span><br><span class="line"><span class="string">verification checksum: 0x80df4dc3 (OK)</span></span><br><span class="line"><span class="string">[find]: apEwF (OK)</span></span><br><span class="line"><span class="string">verification checksum: 0x3f637a50 (OK)</span></span><br><span class="line"><span class="string">^Q6w (OK)</span></span><br><span class="line"><span class="string">[find]: \&lt;0Zk (OK)</span></span><br><span class="line"><span class="string">[find]: a-|23 (OK)</span></span><br><span class="line"><span class="string">[find]: &#125;b 3' (OK)</span></span><br><span class="line"><span class="string">verification checksum: 0xbcd9703b (OK)</span></span><br><span class="line"><span class="string">[find]: hyAo5 (OK)</span></span><br></pre></td></tr></table></figure>
<p>所以密码为：<code>password:f~Z-;lapEwF\&lt;0ZkhyAo5</code></p>
<p>得到<code>XUSTCTF{6ebd0342caa3cf39981b98ee24a1f0ac}</code></p>
<h2 id="简单ECC"><a href="#简单ECC" class="headerlink" title="简单ECC"></a>简单ECC</h2><blockquote>
<p>已知椭圆曲线加密Ep(a,b)参数为</p>
<p>p = 15424654874903</p>
<p>a = 16546484</p>
<p>b = 4548674875</p>
<p>G(6478678675,5636379357093)</p>
<p>私钥为</p>
<p>k = 546768</p>
<p>求公钥K(x,y)</p>
<p>提示：K=kG</p>
<p>提交格式XUSTCTF{x+y}(注意，大括号里面是x和y加起来求和，不是用加号连接)</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!usr/env/python3</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#owner: IFpop</span></span><br><span class="line"><span class="comment">#time: 2019/11/5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">a = <span class="number">16546484</span></span><br><span class="line">b = <span class="number">4548674875</span></span><br><span class="line">M = <span class="number">15424654874903</span></span><br><span class="line">G = (<span class="number">6478678675</span>, <span class="number">5636379357093</span>)</span><br><span class="line"><span class="comment">#初始的K与G是相同的，</span></span><br><span class="line">K = (<span class="number">6478678675</span>,<span class="number">5636379357093</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">546768</span>):</span><br><span class="line">    x1,y1 = K</span><br><span class="line">    x2,y2 = G</span><br><span class="line">    <span class="keyword">if</span> K!=G:</span><br><span class="line">        t = int((y2-y1)*gmpy2.invert(x2-x1,M))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        t = int((<span class="number">3</span>*x1*x1+a)*gmpy2.invert(<span class="number">2</span>*y1,M))</span><br><span class="line">    x3 = t*t-x1-x2</span><br><span class="line">    y3 = t*(x1-x3)-y1</span><br><span class="line">    K = (x3%M,y3%M)</span><br><span class="line">print(<span class="string">"XUSTCTF&#123;"</span>+str(K[<span class="number">0</span>]+K[<span class="number">1</span>])+<span class="string">"&#125;"</span>)</span><br><span class="line"><span class="comment">#XUSTCTF&#123;19477226185390&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="God-Like-RSA"><a href="#God-Like-RSA" class="headerlink" title="God Like RSA"></a>God Like RSA</h2><p><a href="https://ifpop.github.io/2019/10/21/RSA-%E9%9B%86%E9%94%A6/#more">RSA-集锦</a></p>
<h2 id="Extremely-hard-RSA"><a href="#Extremely-hard-RSA" class="headerlink" title="Extremely hard RSA"></a>Extremely hard RSA</h2><p><a href="https://ifpop.github.io/2019/10/21/RSA-%E9%9B%86%E9%94%A6/#more">RSA-集锦</a></p>
<h2 id="very-hard-RSA"><a href="#very-hard-RSA" class="headerlink" title="very hard RSA"></a>very hard RSA</h2><p><a href="https://ifpop.github.io/2019/10/21/RSA-%E9%9B%86%E9%94%A6/#more">RSA-集锦</a></p>
<h2 id="hard-RSA"><a href="#hard-RSA" class="headerlink" title="hard RSA"></a>hard RSA</h2><p><a href="https://ifpop.github.io/2019/10/21/RSA-%E9%9B%86%E9%94%A6/#more">RSA-集锦</a></p>
<h2 id="BrokenPic"><a href="#BrokenPic" class="headerlink" title="BrokenPic"></a>BrokenPic</h2><p>下载下来是一个bmp文件，文件损坏不能打开，使用winhex打开，发现没有bmp文件头,填入文件头重新填入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">42 4D 38 0C 30 00 00 00 00 00 36 00 00 00 28 00 00 00 56 05 00 00 00 03 00 00 01 00 18 00 00 00 00 00 02 0C 30 00 12 0B 00 00 12 0B 00 00 00 00 00 00 00 00 00 00</span><br></pre></td></tr></table></figure>
<p>这里补充一下有关bmp头格式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">//存储方式为小端序</span><br><span class="line">42 4D //2bytes &quot;BM&quot;</span><br><span class="line">36 58 02 00 //4 bytes Total size included &quot;BM&quot; magic(s)</span><br><span class="line">00 00 00 00 //这里必须置为0</span><br><span class="line">36 00 00 00 //从文件开始到位图数据之间的偏移量 这里是54</span><br><span class="line">28 00 00 00 //bitmap head 的大小为40字节</span><br><span class="line">56 05 00 00 //宽度为1366</span><br><span class="line">00 03 00 00 //高度为768</span><br><span class="line">01 00  //这个字的值永远是1</span><br><span class="line">18 00  //每个像素占用的位数</span><br><span class="line">00 00 00 00 //压缩方式</span><br><span class="line">00 0C 30 00 // 3148800的字节大小 这个可通过看文件详细信息得到	</span><br><span class="line">12 0B 00 00  //水平分辨率</span><br><span class="line">12 0B 00 00  //垂直分辨率</span><br><span class="line">00 00 00 00</span><br><span class="line">00 00 00 00</span><br></pre></td></tr></table></figure>
<p>形成新的bmp后，得到里面得内容：</p>
<p><code>key:PHRACK-BROKENPIC</code></p>
<p>和一个不能扫出东西的二维码</p>
<p>现在问题来了，这个key是用来干嘛的，再看看bmp的16进制格式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">D55F7AB07937BA26B22468328A68C1F2</span><br><span class="line">......</span><br><span class="line">后面好像都一样</span><br></pre></td></tr></table></figure>
<p>想到（这个我还真没想到）AES是分组加密，16字节一组，不过目前所学有key的密码貌似也不是很多</p>
<p>尝试AES解密：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#usr/env/python3</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#owner: IFpop</span></span><br><span class="line"><span class="comment">#time: 2019/11/5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">key = <span class="string">"PHRACK-BROKENPIC"</span></span><br><span class="line"><span class="comment">#python3之后加密函数中传入的都是字节形式</span></span><br><span class="line">key = key.encode(<span class="string">"utf-8"</span>)</span><br><span class="line">aes = AES.new(key,mode = AES.MODE_ECB) <span class="comment">#这是ECB的加密形式，以后这种解密还是使用python不需要指定mode</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'brokenpic.bmp'</span>,<span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line">    pic = aes.decrypt(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'ans.bmp'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(pic)</span><br></pre></td></tr></table></figure>
<p>然后也是想之前那样，修复bmp，可以扫码得到<code>flag:PCTF{AES_i5_W3ak_foR_im4ge}</code></p>
<h2 id="Medium-RSA"><a href="#Medium-RSA" class="headerlink" title="Medium RSA"></a>Medium RSA</h2><p><a href="https://ifpop.github.io/2019/10/21/RSA-%E9%9B%86%E9%94%A6/#more">RSA-集锦</a></p>
<h1 id="Basic"><a href="#Basic" class="headerlink" title="Basic"></a>Basic</h1><h2 id="握手包"><a href="#握手包" class="headerlink" title="握手包"></a>握手包</h2><blockquote>
<p>给你握手包，flag是Flag_is_here这个AP的密码，自己看着办吧。</p>
</blockquote>
<p>下载下来一个cap文件，使用wireshark打开后发现，文件应该使加密过的，网上查一下关于cap的破解知识，发现Kali有个自带工具aircrack-ng，进行字典破解(我这里使用的使kali <code>/usr/share/wordlists</code> 目录下的<code>rockyou.txt</code>)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">aircrack-ng wifi.cap -w rockyou.txt</span><br><span class="line"><span class="comment">#11223344</span></span><br></pre></td></tr></table></figure>
<p><code>flag{11223344}</code></p>
<h2 id="德军的密码"><a href="#德军的密码" class="headerlink" title="德军的密码"></a>德军的密码</h2><blockquote>
<p>已知将一个flag以一种加密形式为使用密钥进行加密，使用密钥WELCOMETOCFF加密后密文为 000000000000000000000000000000000000000000000000000101110000110001000000101000000001 请分析出flag。Flag为12位大写字母</p>
</blockquote>
<p>01串的长度为84，题目提示说使12为大写字母，所以将字符串分成12份，每份应该占有7个01串，此时的key正好也右12为，那么无非就是加减乘除异或等运算，尝试发现此时是逐位异或。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!usr/enc/python3</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#owner: IFpop</span></span><br><span class="line"><span class="comment">#time: 2019/11/8</span></span><br><span class="line"></span><br><span class="line">key = <span class="string">"WELCOMETOCFF"</span></span><br><span class="line">bin_c = <span class="string">"000000000000000000000000000000000000000000000000000101110000110001000000101000000001"</span></span><br><span class="line"><span class="comment">#先将字符串分成七段，然后转换成ASCII，随后与key进行异或</span></span><br><span class="line">c = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">12</span>):</span><br><span class="line">    temp = bin_c[i*<span class="number">7</span>:(i+<span class="number">1</span>)*<span class="number">7</span>]</span><br><span class="line">    <span class="comment">#print(temp)</span></span><br><span class="line">    temp = int(temp,<span class="number">2</span>)</span><br><span class="line">    c = c + chr(temp)</span><br><span class="line"><span class="comment">#print(c)</span></span><br><span class="line">str_c = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">12</span>):</span><br><span class="line">    str_c += chr(ord(c[i])^ord(key[i]))</span><br><span class="line">print(str_c)</span><br><span class="line"><span class="comment">#WELCOMECISRG</span></span><br></pre></td></tr></table></figure>
<h2 id="字符串"><a href="#字符串" class="headerlink" title="-.-字符串"></a>-.-字符串</h2><blockquote>
<p>请选手观察以下密文并转换成flag形式</p>
<p>..-. .-.. .- -–. ….. ..—— ..—— -–—— .-–-– ——.. -.. -…. -…. ….. ..…-– ——.. -–..… -.. .-–-– -.. .- -–-–. ..…-– .-–-– ——.. .-–-– ..—— -… -–… -–… -–… -…. …-– ..….- .-–-– -–——</p>
<p>flag形式为32位大写md5</p>
</blockquote>
<p>这看起来像是莫斯电码，尝试解码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag522018d665387d1da931812b77763410</span><br></pre></td></tr></table></figure>
<p>提示说32位大写的md5，去掉flag就是答案。</p>
<h2 id="A-Piece-Of-Cake"><a href="#A-Piece-Of-Cake" class="headerlink" title="A Piece Of Cake"></a>A Piece Of Cake</h2><blockquote>
<p>nit yqmg mqrqn bxw mtjtm nq rqni fiklvbxu mqrqnl xwg dvmnzxu lqjnyxmt xatwnl, rzn nit uxnntm xmt zlzxuuk mtjtmmtg nq xl rqnl. nitmt vl wq bqwltwlzl qw yivbi exbivwtl pzxuvjk xl mqrqnl rzn nitmt vl atwtmxu xamttetwn xeqwa tsftmnl, xwg nit fzruvb, nixn mqrqnl ntwg nq gq lqet qm xuu qj nit jquuqyvwa: xbbtfn tutbnmqwvb fmqamxeevwa, fmqbtll gxnx qm fiklvbxu ftmbtfnvqwl tutbnmqwvbxuuk, qftmxnt xznqwqeqzluk nq lqet gtamtt, eqdt xmqzwg, qftmxnt fiklvbxu fxmnl qj vnltuj qm fiklvbxu fmqbtlltl, ltwlt xwg exwvfzuxnt nitvm twdvmqwetwn, xwg tsivrvn vwntuuvatwn rtixdvqm - tlftbvxuuk rtixdvqm yivbi evevbl izexwl qm qnitm xwvexul. juxa vl lzrlnvnzntfxllvldtmktxlkkqzaqnvn. buqltuk mtuxntg nq nit bqwbtfn qj x mqrqn vl nit jvtug qj lkwnitnvb rvquqak, yivbi lnzgvtl twnvnvtl yiqlt wxnzmt vl eqmt bqefxmxrut nq rtvwal nixw nq exbivwtl.</p>
</blockquote>
<p>这么多字符串一般来说就是替换密码了，先试试比较简单的单表替换密码，<a href="https://quipqiup.com/" target="_blank" rel="noopener">解密</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">the word ro?ot can refer to ?oth physical ro?ots and virtual software agents, ?ut the latter are usually referred to as ?ots. there is no consensus on which machines ?ualify as ro?ots ?ut there is general agreement among e?perts, and the pu?lic, that ro?ots tend to do some or all of the following: accept electronic programming, process data or physical perceptions electronically, operate autonomously to some degree, move around, operate physical parts of itself or physical processes, sense and manipulate their environment, and e?hi?it intelligent ?ehavior - especially ?ehavior which mimics humans or other animals. flag is su?stitutepassisveryeasyyougotit. closely related to the concept of a ro?ot is the field of synthetic ?iology, which studies entities whose nature is more compara?le to ?eings than to machines.</span><br></pre></td></tr></table></figure>
<p>我们很容易可以分析出，r -– b，所以最终的<code>flag:PCTF{substitutepassisveryeasyyougotit}</code></p>
<h2 id="Shellcode"><a href="#Shellcode" class="headerlink" title="Shellcode"></a>Shellcode</h2><blockquote>
<p>作为一个黑客，怎么能不会使用shellcode?</p>
<p>这里给你一段shellcode，你能正确使用并最后得到flag吗？</p>
</blockquote>
<p>关于shellcode，他是利用漏洞执行代码从而获取shellcode一类程序，它实际就是汇编对应的机器码，但由于机器码大多是不可见字符，所以无法直接显示。</p>
<p>开始以为这个是通过base64加密不可见字符得到的，但发现不能解密，百度发现存在着其他的转码方式<a href="https://blog.csdn.net/instruder/article/details/6050048" target="_blank" rel="noopener">链接</a></p>
<p>使用<a href="https://github.com/inquisb/shellcodeexec" target="_blank" rel="noopener">工具</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\shellcodeexec.x32.exe PYIIIIIIIIIIIIIIII7QZjAXP0A0AkAAQ2AB2BB0BBABXP8ABuJIYIhkmKzyCDq4l4FQyBlrRWEahI1tLKT16Pnk1ftLnkPvwlnkW6fhNkan5pNkgF6XPOR8T5HsCivaN19okQSPlKRLvD6DNk3uelNkpTthRXuQ9znk2jEHLK1Ja0FaXkhcTtBink4tlKUQhnvQYotqo0ylnLMTO0SDEWZahOtMwqhG8kXteksLwTdh1e8aLKsja4uQ8kavLKdLrklK0ZeL7qjKLKUTLKuQM8k9bdvDeL1qiSnR5XVIXTOyjENikrphNnrnVnhlBrzHooKOYoyok93u7tOKCNyHzBBSnguLgTcbyxlNKOYoYoMYaUTHphRL2LupQQ0htsFRTn541x3E2Se5T26PyKK8QLTddJlIZFBvyoSeUTLIkrv0oKy8ORpMmlk7Gl6DBrm8SoyoioyoaxrOqh0XwP1xu1Qw1upBbHrmrED3T34qiKOxQLTdEZOyZCaxQmRxgPUp0hpnPn4srRe8BDSo2PT7axqOCWROpophSYpnSo04u83K72Peu70hBpCsqDpF4qHIMXpLQ429k98aEaJr1BF3Ca3bIozp01IPf0Yof5GxAA</span><br></pre></td></tr></table></figure>
<p>弹窗出<code>flag:PCTF{Begin_4_good_pwnn3r}</code></p>
<h2 id="Help"><a href="#Help" class="headerlink" title="Help!!"></a>Help!!</h2><blockquote>
<p>出题人硬盘上找到一个神秘的压缩包，里面有个word文档，可是好像加密了呢~让我们一起分析一下吧！</p>
</blockquote>
<p>下载一个压缩包，说是加密了，其实是个伪加密，winhex改一下，得到一张图片</p>
<p>开始以为是图片隐写，发现没有藏信息在16进制之中，而且不是LSB隐写，</p>
<p>后来想到word.docx中会不会还有东西，使用<code>binwalk</code>分解一下，发现在/word/media中存在着另一张图片，得到flag</p>
<p><img src="/2019/11/08/Jarvisoj-wp/Users/X1TABLET/Desktop/image2.png" alt="image2"></p>
<h2 id="Baby’s-Crack"><a href="#Baby’s-Crack" class="headerlink" title="Baby’s Crack"></a>Baby’s Crack</h2><blockquote>
<p>既然是逆向题，我废话就不多说了，自己看着办吧。</p>
</blockquote>
<p>下载下来有两个文件，一个exe程序，一个flag.enc程序，题目说是逆向题，所以还是直接使用ida打开看看</p>
<p>查看main函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">_main(*(_QWORD *)&amp;argc, argv, envp);</span><br><span class="line"> <span class="keyword">if</span> ( v8 &lt;= <span class="number">1</span> )</span><br><span class="line"> &#123;</span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">"Usage: %s [FileName]\n"</span>, *v9);</span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">"FileName是待加密的文件"</span>);</span><br><span class="line">   <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> File = fopen(v9[<span class="number">1</span>], <span class="string">"rb+"</span>);</span><br><span class="line"> <span class="keyword">if</span> ( File )</span><br><span class="line"> &#123;</span><br><span class="line">   v5 = fopen(<span class="string">"tmp"</span>, <span class="string">"wb+"</span>);</span><br><span class="line">   <span class="keyword">while</span> ( feof(File) == <span class="number">0</span> )</span><br><span class="line">   &#123;</span><br><span class="line">     v7 = fgetc(File);</span><br><span class="line">     <span class="keyword">if</span> ( v7 != <span class="number">-1</span> &amp;&amp; v7 )</span><br><span class="line">     &#123;</span><br><span class="line">       <span class="comment">//此处是核心代码，对于每个文件中的字符进行下列操作，所以我们只需要逆一下就行</span></span><br><span class="line">       <span class="keyword">if</span> ( v7 &gt; <span class="number">47</span> &amp;&amp; v7 &lt;= <span class="number">96</span> )</span><br><span class="line">       &#123;</span><br><span class="line">         v7 += <span class="number">53</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">else</span> <span class="keyword">if</span> ( v7 &lt;= <span class="number">46</span> )</span><br><span class="line">       &#123;</span><br><span class="line">         v7 += v7 % <span class="number">11</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line">       &#123;</span><br><span class="line">         v7 = <span class="number">61</span> * (v7 / <span class="number">61</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       fputc(v7, v5);</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   fclose(v5);</span><br><span class="line">   fclose(File);</span><br><span class="line">   <span class="built_in">sprintf</span>(&amp;Dest, <span class="string">"del %s"</span>, v9[<span class="number">1</span>]);</span><br><span class="line">   system(&amp;Dest);</span><br><span class="line">   <span class="built_in">sprintf</span>(&amp;Dest, <span class="string">"ren tmp %s"</span>, v9[<span class="number">1</span>]);</span><br><span class="line">   system(&amp;Dest);</span><br><span class="line">   result = <span class="number">0</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line"> &#123;</span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">"无法打开文件%s\n"</span>, v9[<span class="number">1</span>]);</span><br><span class="line">   result = <span class="number">-1</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> result;</span><br></pre></td></tr></table></figure>
<p>下面是解题程序：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!usr/env/python3</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#owner: IFpop</span></span><br><span class="line"><span class="comment">#time: 2019/11/12</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">enc = <span class="string">"jeihjiiklwjnk&#123;ljj&#123;kflghhj&#123;ilk&#123;k&#123;kij&#123;ihlgkfkhkwhhjgly"</span></span><br><span class="line">m = <span class="string">""</span></span><br><span class="line">length = len(enc)</span><br><span class="line">dic = string.printable</span><br><span class="line">tag = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(length):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> dic:</span><br><span class="line">        <span class="keyword">if</span> ord(j) &gt; <span class="number">47</span> <span class="keyword">and</span> ord(j) &lt;= <span class="number">96</span>:</span><br><span class="line">            temp = chr(ord(j)+<span class="number">53</span>)</span><br><span class="line">        <span class="keyword">elif</span> ord(j) &lt;= <span class="number">46</span>:</span><br><span class="line">            temp = chr(ord(j)+ord(j)%<span class="number">11</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            temp = chr(<span class="number">61</span>*(ord(j)//<span class="number">61</span>))</span><br><span class="line">        <span class="comment"># print(temp)</span></span><br><span class="line">        <span class="keyword">if</span> temp == enc[i]:</span><br><span class="line">            print(j)</span><br><span class="line">            m += j</span><br><span class="line"><span class="comment">#m = 504354467B596F755F6172335F476F6F645F437261636B33527D</span></span><br><span class="line"><span class="comment">#明文是16进制编码</span></span><br><span class="line">print(bytes.fromhex(m))</span><br></pre></td></tr></table></figure>
<h2 id="熟悉的声音"><a href="#熟悉的声音" class="headerlink" title="熟悉的声音"></a>熟悉的声音</h2><blockquote>
<p>两种不同的元素，如果是声音的话，听起来是不是很熟悉呢，据说前不久神盾局某位特工领便当了大家都很惋惜哦</p>
<p>XYYY YXXX XYXX XXY XYY X XYY YX YYXX</p>
<p>请提交PCTF{你的答案}</p>
</blockquote>
<p>特工，声音，密码，这不就是摩斯电码嘛，现在就是需要知道X,Y分别代表什么</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!usr/env/python3</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将两种情况都打印一遍</span></span><br><span class="line">s = <span class="string">"XYYY YXXX XYXX XXY XYY X XYY YX YYXX"</span></span><br><span class="line">s = s.replace(<span class="string">'X'</span>,<span class="string">'.'</span>)</span><br><span class="line">s = s.replace(<span class="string">'Y'</span>,<span class="string">'-'</span>)</span><br><span class="line">print(s)</span><br><span class="line"><span class="comment">#.--- -... .-.. ..- .-- . .-- -. --..</span></span><br><span class="line">s = <span class="string">"XYYY YXXX XYXX XXY XYY X XYY YX YYXX"</span></span><br><span class="line">s = s.replace(<span class="string">'X'</span>,<span class="string">'-'</span>)</span><br><span class="line">s = s.replace(<span class="string">'Y'</span>,<span class="string">'.'</span>)</span><br><span class="line">print(s)</span><br><span class="line"><span class="comment">#-... .--- -.-- --. -.. - -.. .- ..--</span></span><br><span class="line"><span class="comment">#jbluwewnz</span></span><br></pre></td></tr></table></figure>
<p>发现这也不是个有意义的字符，可能是flag,交上去发现不对，可能还有加密，尝试常用的一些解密方式</p>
<p>凯撒解密，发现这样一个字符串<code>phrackctf</code>，交上去发现不对，查询才知道，摩斯电码只能是大写</p>
<p><code>PCTF{PHRACKCTF}</code></p>
<h2 id="取证"><a href="#取证" class="headerlink" title="取证"></a>取证</h2><blockquote>
<p>有一款取证神器如下图所示，可以从内存dump里分析出TureCrypt的密钥，你能找出这款软件的名字吗？名称请全部小写。</p>
<p><img src="/2019/11/08/Jarvisoj-wp/Users\96552\AppData\Roaming\Typora\typora-user-images\1573611867291.png" alt="1573611867291"></p>
<p>提交格式：PCTF{软件名字}</p>
</blockquote>
<p>搜索内存取证神器，发现一篇<a href="https://cloud.tencent.com/developer/article/1076631" target="_blank" rel="noopener">博客</a>，<code>flag：PCTF{volatility}</code></p>
<h2 id="ROPGadget"><a href="#ROPGadget" class="headerlink" title="ROPGadget"></a>ROPGadget</h2><blockquote>
<p>都说学好汇编是学习PWN的基础，以下有一段ROPGadget的汇编指令序列，请提交其十六进制机器码(大写，不要有空格)</p>
<p>XCHG EAX,ESP</p>
<p>RET</p>
<p>MOV ECX,[EAX]</p>
<p>MOV [EDX],ECX</p>
<p>POP EBX</p>
<p>RET</p>
<p>提交格式：PCTF{你的答案}</p>
</blockquote>
<p>说是要将上述汇编指令转换为机器码，好多种方法，这里我使用一个转换工具，得到<code>94C38B08890A5BC3</code></p>
<p>所以<code>PCTF{94C38B08890A5BC3}</code></p>
<h2 id="Easy-RSA"><a href="#Easy-RSA" class="headerlink" title="Easy RSA"></a>Easy RSA</h2><blockquote>
<p>还记得veryeasy RSA吗？是不是不难？那继续来看看这题吧，这题也不难。</p>
<p>已知一段RSA加密的信息为：0xdc2eeeb2782c且已知加密所用的公钥：</p>
<p>(N=322831561921859 e = 23)</p>
<p>请解密出明文，提交时请将数字转化为ascii码提交</p>
<p>比如你解出的明文是0x6162，那么请提交字符串ab</p>
<p>提交格式:PCTF{明文字符串}</p>
</blockquote>
<ol>
<li><p>尝试将模数N进行<a href="www.factordb.com">分解</a></p>
<p>得到<code>p =  13574881  q = 23781539</code></p>
</li>
<li><p>下面就可以开始解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!usr/env/python3</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#owner: IFpop</span></span><br><span class="line"><span class="comment">#time: 2019/11/13</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line">p = <span class="number">13574881</span></span><br><span class="line">q = <span class="number">23781539</span></span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">23</span></span><br><span class="line">c = <span class="number">0xdc2eeeb2782c</span></span><br><span class="line">fn = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,fn)</span><br><span class="line">m = pow(c,d,n)</span><br><span class="line">print(number.long_to_bytes(m))</span><br><span class="line"><span class="comment">#3a5Y</span></span><br></pre></td></tr></table></figure>
<p>所以<code>PCTF{3a5Y}</code></p>
</li>
</ol>
<h2 id="爱吃培根的出题人"><a href="#爱吃培根的出题人" class="headerlink" title="爱吃培根的出题人"></a>爱吃培根的出题人</h2><blockquote>
<p>听说你也喜欢吃培根？那我们一起来欣赏一段培根的介绍吧：</p>
<p>bacoN is one of aMerICa’S sWEethEartS. it’s A dARlinG, SuCCulEnt fOoD tHAt PaIRs FlawLE</p>
<p>什么，不知道要干什么？上面这段巨丑无比的文字，为什么会有大小写呢？你能发现其中的玄机吗？</p>
<p>提交格式：PCTF{你发现的玄机}</p>
</blockquote>
<p>提示很明显是培根密码，但我们知道培根密码是由A,B两个字符组成的特殊隐写方式，题目中说大小写？玄机？</p>
<p>大小写与A，B对应，这样就可以算是培根了，但具体是大写与A还是小写与A还得测试一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#以维基百科上的为准</span></span><br><span class="line">dic = &#123;<span class="string">'AAAAA'</span>:<span class="string">'a'</span>,<span class="string">'AAAAB'</span>:<span class="string">'b'</span>,<span class="string">'AAABA'</span>:<span class="string">'c'</span>,<span class="string">'AAABB'</span>:<span class="string">'d'</span>,<span class="string">'AABAA'</span>:<span class="string">'e'</span>,<span class="string">'AABAB'</span>:<span class="string">'f'</span>,</span><br><span class="line">        <span class="string">'AABBA'</span>:<span class="string">'g'</span>,<span class="string">'AABBB'</span>:<span class="string">'h'</span>,<span class="string">'ABAAA'</span>:<span class="string">'i/j'</span>,<span class="string">'ABAAB'</span>:<span class="string">'k'</span>,<span class="string">'ABABA'</span>:<span class="string">'l'</span>,<span class="string">'ABABB'</span>:<span class="string">'m'</span>,</span><br><span class="line">        <span class="string">'ABBAA'</span>:<span class="string">'n'</span>,<span class="string">'ABBAB'</span>:<span class="string">'o'</span>,<span class="string">'ABBBA'</span>:<span class="string">'p'</span>,<span class="string">'ABBBB'</span>:<span class="string">'q'</span>,<span class="string">'BAAAA'</span>:<span class="string">'r'</span>,<span class="string">'BAAAB'</span>:<span class="string">'s'</span>,</span><br><span class="line">        <span class="string">'BAABA'</span>:<span class="string">'t'</span>,<span class="string">'BAABB'</span>:<span class="string">'u/v'</span>,<span class="string">'BABAA'</span>:<span class="string">'w'</span>,<span class="string">'BABAB'</span>:<span class="string">'x'</span>,<span class="string">'BABBA'</span>:<span class="string">'y'</span>,<span class="string">'BABBB'</span>:<span class="string">'z'</span>&#125;</span><br><span class="line">    </span><br><span class="line">init = <span class="string">"bacoN is one of aMerICa'S sWEethEartS. it's A dARlinG, SuCCulEnt fOoD tHAt PaIRs FlawLE"</span></span><br><span class="line">init = init.replace(<span class="string">' '</span>,<span class="string">''</span>).replace(<span class="string">'.'</span>,<span class="string">''</span>).replace(<span class="string">','</span>,<span class="string">''</span>).replace(<span class="string">"'"</span>,<span class="string">''</span>)</span><br><span class="line">s1 = <span class="string">""</span></span><br><span class="line">s2 = <span class="string">""</span></span><br><span class="line">ans1 = []</span><br><span class="line">ans2 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> init:</span><br><span class="line">    <span class="keyword">if</span> i.isupper():</span><br><span class="line">        s1 += <span class="string">'A'</span></span><br><span class="line">        s2 += <span class="string">'B'</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        s1 += <span class="string">'B'</span></span><br><span class="line">        s2 += <span class="string">'A'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(s1)//<span class="number">5</span>):</span><br><span class="line">    ans1.append(s1[i*<span class="number">5</span>:i*<span class="number">5</span>+<span class="number">5</span>])</span><br><span class="line">    ans2.append(s2[i*<span class="number">5</span>:i*<span class="number">5</span>+<span class="number">5</span>])</span><br><span class="line"><span class="comment"># print(ans1)</span></span><br><span class="line">print(ans2)</span><br><span class="line"><span class="comment"># for i in range(len(ans1)):</span></span><br><span class="line"><span class="comment">#     ans1[i] = dic[ans1[i]]</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(ans2)):</span><br><span class="line">    ans2[i] = dic[ans2[i]]</span><br><span class="line"><span class="comment"># print(''.join(ans1))</span></span><br><span class="line">print(<span class="string">''</span>.join(ans2))</span><br><span class="line"><span class="comment">#baconi/jsnotfood</span></span><br></pre></td></tr></table></figure>
<p>所以最后应该是<code>PCTF{baconisnotfood}</code></p>
<h2 id="Secret"><a href="#Secret" class="headerlink" title="Secret"></a>Secret</h2><blockquote>
<p>传说中的签到题</p>
<p>题目入口：<a href="http://web.jarvisoj.com:32776/" target="_blank" rel="noopener">http://web.jarvisoj.com:32776/</a></p>
<p>Hint1: 提交格式PCTF{你发现的秘密}</p>
</blockquote>
<p>页面没有信息，那就只有消息头会藏信息了，查看消息头，发现<code>Welcome_to_phrackCTF_2016</code></p>
<h2 id="Easy-Crackme"><a href="#Easy-Crackme" class="headerlink" title="Easy Crackme"></a>Easy Crackme</h2><blockquote>
<p>都说逆向挺难的，但是这题挺容易的，反正我不会，大家来挑战一下吧~~:)</p>
</blockquote>
<p>使用ida64打开， 找到main函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rdi</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// [rsp+0h] [rbp-38h]</span></span><br><span class="line">  <span class="keyword">char</span> v6; <span class="comment">// [rsp+1h] [rbp-37h]</span></span><br><span class="line">  <span class="keyword">char</span> v7; <span class="comment">// [rsp+2h] [rbp-36h]</span></span><br><span class="line">  <span class="keyword">char</span> v8; <span class="comment">// [rsp+3h] [rbp-35h]</span></span><br><span class="line">  <span class="keyword">char</span> v9; <span class="comment">// [rsp+4h] [rbp-34h]</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// [rsp+5h] [rbp-33h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int8 v11; <span class="comment">// [rsp+10h] [rbp-28h]</span></span><br><span class="line">  _BYTE v12[<span class="number">7</span>]; <span class="comment">// [rsp+11h] [rbp-27h]</span></span><br><span class="line"></span><br><span class="line">  v5 = <span class="number">0xAB</span>u;</span><br><span class="line">  v6 = <span class="number">0xDD</span>u;</span><br><span class="line">  v7 = <span class="number">0x33</span>;</span><br><span class="line">  v8 = <span class="number">0x54</span>;</span><br><span class="line">  v9 = <span class="number">0x35</span>;</span><br><span class="line">  v10 = <span class="number">0xEF</span>u;</span><br><span class="line">  <span class="built_in">printf</span>((<span class="keyword">unsigned</span> __int64)<span class="string">"Input your password:"</span>);</span><br><span class="line">  _isoc99_scanf((<span class="keyword">unsigned</span> __int64)<span class="string">"%s"</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v11) == <span class="number">26</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = <span class="number">0L</span>L;</span><br><span class="line">    <span class="keyword">if</span> ( (v11 ^ <span class="number">0xAB</span>) == list1 )  <span class="comment">//list1 0xFB 判断第一位异或的结果</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span> ( (v12[v3] ^ (<span class="keyword">unsigned</span> __int8)*(&amp;v5 + ((<span class="keyword">signed</span> <span class="keyword">int</span>)v3 + <span class="number">1</span>) % <span class="number">6</span>)) == byte_6B41D1[v3] )  <span class="comment">//9E 67 12 4E 9D 98 AB 0 6 46  8A F4 B4 6 0B 43 DC D9 A4 6C 31 74 9C D2 A0   与上面的v5开始的6位数进行异或</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( ++v3 == <span class="number">25</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">printf</span>((<span class="keyword">unsigned</span> __int64)<span class="string">"Congratulations!"</span>);</span><br><span class="line">          <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>((<span class="keyword">unsigned</span> __int64)<span class="string">"Password Wrong!! Please try again."</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>逻辑还是比较清楚的，现在就直接写脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"></span><br><span class="line">s = [<span class="number">0x9E</span>,<span class="number">0x67</span>,<span class="number">0x12</span>,<span class="number">0x4E</span>,<span class="number">0x9D</span>,<span class="number">0x98</span>,<span class="number">0xAB</span>,<span class="number">0</span>,<span class="number">0x6</span>,<span class="number">0x46</span>,<span class="number">0x8A</span>,<span class="number">0xF4</span>,<span class="number">0xB4</span>,<span class="number">0x6</span>,<span class="number">0x0B</span>,<span class="number">0x43</span>,<span class="number">0xDC</span>,<span class="number">0xD9</span>,<span class="number">0xA4</span>,<span class="number">0x6C</span>,<span class="number">0x31</span>,<span class="number">0x74</span>,<span class="number">0x9C</span>,<span class="number">0xD2</span>,<span class="number">0xA0</span>]</span><br><span class="line">s2 = [<span class="number">0xAB</span>,<span class="number">0xDD</span>,<span class="number">0x33</span>,<span class="number">0x54</span>,<span class="number">0x35</span>,<span class="number">0xEF</span>]</span><br><span class="line">flag =<span class="string">"P"</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    flag += chr(i^s2[(j+<span class="number">1</span>)%<span class="number">6</span>])</span><br><span class="line">    j = j+<span class="number">1</span></span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment">#PCTF&#123;r3v3Rse_i5_v3ry_eAsy&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="公倍数"><a href="#公倍数" class="headerlink" title="公倍数"></a>公倍数</h2><blockquote>
<p>请计算1000000000以内3或5的倍数之和。</p>
<p>如：10以内这样的数有3,5,6,9，和是23</p>
<p>请提交PCTF{你的答案}</p>
</blockquote>
<p>直接爆破，就行~</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"></span><br><span class="line">sum = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">1000000000</span>):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">3</span> == <span class="number">0</span> <span class="keyword">or</span> i%<span class="number">5</span> == <span class="number">0</span>:</span><br><span class="line">        sum+=i</span><br><span class="line">print(sum)</span><br></pre></td></tr></table></figure>
<h2 id="神秘的文件"><a href="#神秘的文件" class="headerlink" title="神秘的文件"></a>神秘的文件</h2><blockquote>
<p>出题人太懒，还是就丢了个文件就走了，你能发现里面的秘密吗？</p>
</blockquote>
<p>下载一个文件，将其file一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Linux rev 1.0 ext2 filesystem data, UUID=8eecd08f-bae8-41ff-8497-8338f58ad15b</span><br></pre></td></tr></table></figure>
<p>是linux的磁盘文件，使用binwalk 查看文件，看是否可以分离，随后就产生了256个文件，使用winhex打开查看，每个文件中仅有一个字符，所以256个文件连起来应该是我们需要的信息，下面写个脚本处理一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!usr/env/python</span></span><br><span class="line"><span class="comment">#owner: IFpop</span></span><br><span class="line"><span class="comment">#time: 2019/11/14</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"></span><br><span class="line">ans =<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">253</span>):</span><br><span class="line">    <span class="keyword">with</span> open(str(i),<span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        ans += f.read()</span><br><span class="line">print(ans)</span><br></pre></td></tr></table></figure>
<p>得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Haha ext2 file system is easy, and I know you can easily decompress of it and find the content in it.But the content is spilted in pieces can you make the pieces together. Now this is the flag PCTF&#123;P13c3_7oghter_i7&#125;. The rest is up to you. Cheer up, boy</span><br></pre></td></tr></table></figure>
<h2 id="veryeasyRSA"><a href="#veryeasyRSA" class="headerlink" title="veryeasyRSA"></a>veryeasyRSA</h2><blockquote>
<p>已知RSA公钥生成参数：</p>
<p>p = 3487583947589437589237958723892346254777 q = 8767867843568934765983476584376578389</p>
<p>e = 65537</p>
<p>求d = </p>
<p>请提交PCTF{d}</p>
</blockquote>
<p>直接解就行：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = <span class="number">3487583947589437589237958723892346254777</span> </span><br><span class="line">q = <span class="number">8767867843568934765983476584376578389</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">fn = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">d = gmpy2.invert(e,fn)</span><br><span class="line">print(d)</span><br><span class="line"><span class="comment">#19178568796155560423675975774142829153827883709027717723363077606260717434369</span></span><br></pre></td></tr></table></figure>
<h2 id="美丽的实验室logo"><a href="#美丽的实验室logo" class="headerlink" title="美丽的实验室logo"></a>美丽的实验室logo</h2><blockquote>
<p>​    出题人丢下个logo就走了，大家自己看着办吧</p>
</blockquote>
<p>下载下来一个jpg，使用binwalk啥的也没有发现藏有神秘东西，可能是LSB，使用stegsolve打开，</p>
<p>使用Frame browser拿到flag</p>
<h2 id="手贱"><a href="#手贱" class="headerlink" title="手贱"></a>手贱</h2><blockquote>
<p>某天A君的网站被日，管理员密码被改，死活登不上，去数据库一看，啥，这密码md5不是和原来一样吗？为啥登不上咧？</p>
<p>d78b6f302l25cdc811adfe8d4e7c9fd34</p>
<p>请提交PCTF{原来的管理员密码}</p>
</blockquote>
<p>看了半天，不知道问题在哪。。后来才知道这里的md5的长度是33位，有一位是多出来的，遍历一下，逐个解就行</p>
<h2 id="段子"><a href="#段子" class="headerlink" title="段子"></a>段子</h2><blockquote>
<p>程序猿圈子里有个非常著名的段子：</p>
<p>手持两把锟斤拷，口中疾呼烫烫烫。</p>
<p>请提交其中“锟斤拷”的十六进制编码。(大写)</p>
<p>FLAG: PCTF{你的答案}</p>
</blockquote>
<p>用python转一下就行，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">'锟斤拷'</span>.decode(<span class="string">'utf-8'</span>).encode(<span class="string">'gbk'</span>).encode(<span class="string">'hex'</span>)</span><br><span class="line"><span class="keyword">print</span> s.upper()</span><br></pre></td></tr></table></figure>
<h2 id="veryeasy"><a href="#veryeasy" class="headerlink" title="veryeasy"></a>veryeasy</h2><blockquote>
<p>使用基本命令获取flag</p>
</blockquote>
<p>strings一下即可得到flag</p>
<h2 id="关于USS-lab"><a href="#关于USS-lab" class="headerlink" title="关于USS    lab"></a>关于USS    lab</h2><blockquote>
<p>USS的英文全称是什么，请全部小写并使用下划线连接_，并在外面加上PCTF{}之后提交</p>
</blockquote>
<p>百度一下即可，<code>PCTF{ubiquitous_system_security}</code></p>
<h2 id="base64"><a href="#base64" class="headerlink" title="base64?"></a>base64?</h2><blockquote>
<p>GUYDIMZVGQ2DMN3CGRQTONJXGM3TINLGG42DGMZXGM3TINLGGY4DGNBXGYZTGNLGGY3DGNBWMU3WI===</p>
</blockquote>
<p>特征很明显是base32，解密：<code>504354467b4a7573745f743373745f683476335f66346e7d</code></p>
<p>好像是16进制，转一下：<code>PCTF{Just_t3st_h4v3_f4n}</code></p>

      
    </div>
    
    
    
    <div>
    
      <div>

    <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>

</div>
    
    </div>
    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Jarvisoj/" rel="tag"><i class="fa fa-tag"></i> Jarvisoj</a>
          
        </div>
      
      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/10/25/SmartCar-study/" rel="next" title="SmartCar-study">
                <i class="fa fa-chevron-left"></i> SmartCar-study
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/11/12/2019湖湘杯/" rel="prev" title="2019湖湘杯">
                2019湖湘杯 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      
        <div id="gitment-container"></div>
      
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">IFpop</p>
              <p class="site-description motion-element" itemprop="description">IFpop的个人站</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">21</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                友链
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://m4x.fun" title="M4x" target="_blank">M4x</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://code.felinae98.cn" title="唐老板" target="_blank">唐老板</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.cnblogs.com/ZHijack" title="谱尼" target="_blank">谱尼</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://l1b0.fun" title="L1B0" target="_blank">L1B0</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://izayoi.cn/" title="IZAYOI" target="_blank">IZAYOI</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://m0yuqi.cn" title="雨琦姐姐" target="_blank">雨琦姐姐</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Crypto"><span class="nav-number">1.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Xgm"><span class="nav-number">1.1.</span> <span class="nav-text">Xgm</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#xbk"><span class="nav-number">1.2.</span> <span class="nav-text">xbk</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#xyf"><span class="nav-number">1.3.</span> <span class="nav-text">xyf</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#xcaesar"><span class="nav-number">1.4.</span> <span class="nav-text">xcaesar</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#xbase64"><span class="nav-number">1.5.</span> <span class="nav-text">xbase64</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Cry"><span class="nav-number">1.6.</span> <span class="nav-text">Cry</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rsa"><span class="nav-number">1.7.</span> <span class="nav-text">rsa</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rsappend"><span class="nav-number">1.8.</span> <span class="nav-text">rsappend</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#bbencode"><span class="nav-number">1.9.</span> <span class="nav-text">bbencode</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Complicated-Crypto"><span class="nav-number">1.10.</span> <span class="nav-text">Complicated Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#CRC爆破"><span class="nav-number">1.10.1.</span> <span class="nav-text">CRC爆破</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#vigenere"><span class="nav-number">1.10.2.</span> <span class="nav-text">vigenere</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sha1爆破"><span class="nav-number">1.10.3.</span> <span class="nav-text">sha1爆破</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MD5"><span class="nav-number">1.10.4.</span> <span class="nav-text">MD5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RSA"><span class="nav-number">1.10.5.</span> <span class="nav-text">RSA</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DSA"><span class="nav-number">1.11.</span> <span class="nav-text">DSA</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#知识点"><span class="nav-number">1.11.1.</span> <span class="nav-text">知识点</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#概述"><span class="nav-number">1.11.1.1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#其他知识点"><span class="nav-number">1.11.1.2.</span> <span class="nav-text">其他知识点</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#解题"><span class="nav-number">1.11.2.</span> <span class="nav-text">解题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#vigenere-1"><span class="nav-number">1.12.</span> <span class="nav-text">vigenere</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#superexpress"><span class="nav-number">1.13.</span> <span class="nav-text">superexpress</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#好多盐"><span class="nav-number">1.14.</span> <span class="nav-text">好多盐</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#影之密码"><span class="nav-number">1.15.</span> <span class="nav-text">影之密码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Jarvis’s-encryption-system"><span class="nav-number">1.16.</span> <span class="nav-text">Jarvis’s encryption system</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#神秘压缩包"><span class="nav-number">1.17.</span> <span class="nav-text">神秘压缩包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#简单ECC"><span class="nav-number">1.18.</span> <span class="nav-text">简单ECC</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#God-Like-RSA"><span class="nav-number">1.19.</span> <span class="nav-text">God Like RSA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Extremely-hard-RSA"><span class="nav-number">1.20.</span> <span class="nav-text">Extremely hard RSA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#very-hard-RSA"><span class="nav-number">1.21.</span> <span class="nav-text">very hard RSA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hard-RSA"><span class="nav-number">1.22.</span> <span class="nav-text">hard RSA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BrokenPic"><span class="nav-number">1.23.</span> <span class="nav-text">BrokenPic</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Medium-RSA"><span class="nav-number">1.24.</span> <span class="nav-text">Medium RSA</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Basic"><span class="nav-number">2.</span> <span class="nav-text">Basic</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#握手包"><span class="nav-number">2.1.</span> <span class="nav-text">握手包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#德军的密码"><span class="nav-number">2.2.</span> <span class="nav-text">德军的密码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#字符串"><span class="nav-number">2.3.</span> <span class="nav-text">-.-字符串</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#A-Piece-Of-Cake"><span class="nav-number">2.4.</span> <span class="nav-text">A Piece Of Cake</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Shellcode"><span class="nav-number">2.5.</span> <span class="nav-text">Shellcode</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Help"><span class="nav-number">2.6.</span> <span class="nav-text">Help!!</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Baby’s-Crack"><span class="nav-number">2.7.</span> <span class="nav-text">Baby’s Crack</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#熟悉的声音"><span class="nav-number">2.8.</span> <span class="nav-text">熟悉的声音</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#取证"><span class="nav-number">2.9.</span> <span class="nav-text">取证</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ROPGadget"><span class="nav-number">2.10.</span> <span class="nav-text">ROPGadget</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Easy-RSA"><span class="nav-number">2.11.</span> <span class="nav-text">Easy RSA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#爱吃培根的出题人"><span class="nav-number">2.12.</span> <span class="nav-text">爱吃培根的出题人</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Secret"><span class="nav-number">2.13.</span> <span class="nav-text">Secret</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Easy-Crackme"><span class="nav-number">2.14.</span> <span class="nav-text">Easy Crackme</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#公倍数"><span class="nav-number">2.15.</span> <span class="nav-text">公倍数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#神秘的文件"><span class="nav-number">2.16.</span> <span class="nav-text">神秘的文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#veryeasyRSA"><span class="nav-number">2.17.</span> <span class="nav-text">veryeasyRSA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#美丽的实验室logo"><span class="nav-number">2.18.</span> <span class="nav-text">美丽的实验室logo</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#手贱"><span class="nav-number">2.19.</span> <span class="nav-text">手贱</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#段子"><span class="nav-number">2.20.</span> <span class="nav-text">段子</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#veryeasy"><span class="nav-number">2.21.</span> <span class="nav-text">veryeasy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#关于USS-lab"><span class="nav-number">2.22.</span> <span class="nav-text">关于USS    lab</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#base64"><span class="nav-number">2.23.</span> <span class="nav-text">base64?</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2019 &mdash; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-snowflake-o"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">IFpop</span>

  
</div>









        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i> 访问人数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i> 总访问量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  







<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <!-- 请使用下面的替换  2019-06-30更新-->
        <link rel="stylesheet" href="https://billts.site/extra_css/gitment.css">
        <script src="https://billts.site/js/gitment.js"></script>
    
<!-- END LOCAL -->

    
      <style>
        a.gitment-editor-footer-tip { display: none; }
        .gitment-container.gitment-footer-container { display: none; }
      </style>
    

    
      <script type="text/javascript">
      function renderGitment(){
        var gitment = new Gitment({
            id: '1573143467000', 
            owner: 'IFpop',
            repo: 'blog-comments',
            
            oauth: {
            
            
                client_secret: 'd50c66f5d4506f10ba8384d04bbd7be2d9c8fc81',
            
                client_id: 'b9f6019a4a776023a56d'
            }});
        gitment.render('gitment-container');
      }

      
      renderGitment();
      
      </script>
    







  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>